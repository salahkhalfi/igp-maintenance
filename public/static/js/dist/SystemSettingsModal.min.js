const SystemSettingsModal=({show:e,onClose:t,currentUser:a})=>{const[r,s]=React.useState("-5"),[l,n]=React.useState(!0),[c,i]=React.useState(!1),[o,m]=React.useState(null),[d,u]=React.useState(null),[p,g]=React.useState(!1),[b,x]=React.useState("/api/settings/logo"),[f,E]=React.useState(Date.now()),[R,y]=React.useState(!1),[v,N]=React.useState(!1),[h,w]=React.useState("Gestion de la maintenance et des réparations"),[C,_]=React.useState("Système de Maintenance Universel"),[U,L]=React.useState(""),[S,A]=React.useState(!1),[k,T]=React.useState(!1),[I,P]=React.useState(!1),[j,D]=React.useState(""),[M,z]=React.useState(""),[q,V]=React.useState(""),[F,O]=React.useState(!1),[W,B]=React.useState(!1),[H,G]=React.useState(!1),[Q,K]=React.useState(""),[Z,J]=React.useState(!1),[X,Y]=React.useState(""),[$,ee]=React.useState(!1),[te,ae]=React.useState("Connect"),[re,se]=React.useState(!1),[le,ne]=React.useState(""),[ce,ie]=React.useState(!1),[oe,me]=React.useState(""),[de,ue]=React.useState(!1),[pe,ge]=React.useState(""),[be,xe]=React.useState(!1),[fe,Ee]=React.useState(""),[Re,ye]=React.useState(!1),[ve,Ne]=React.useState(""),[he,we]=React.useState(!1),[Ce,_e]=React.useState(!1),[Ue,Le]=React.useState(!1),[Se,Ae]=React.useState({placeholder_machine_type:"Ex: Équipement, Machine...",placeholder_location:"Ex: Zone A, Atelier...",placeholder_manufacturer:"Ex: Marque, Fabricant..."}),[ke,Te]=React.useState(!1),[Ie,Pe]=React.useState({}),[je,De]=React.useState(!1),[Me,ze]=React.useState({planning:!0,statistics:!0,notifications:!0,messaging:!0,machines:!0}),[qe,Ve]=React.useState({planning:!0,statistics:!0,notifications:!0,messaging:!0,machines:!0});React.useEffect(()=>{if(e){(async()=>{let e=!1,t=!1;a&&(!0===a.isSuperAdmin?(e=!0,t=!0):"admin"===a.role&&(t=!0)),y(e),N(t),await Oe(t),Fe()})()}},[e,a]);const Fe=async()=>{try{const e=await axios.get(API_URL+"/settings/modules/status");ze(e.data);const t=await axios.get(API_URL+"/settings/modules/preferences");Ve(t.data)}catch(e){console.error(e)}},Oe=async e=>{n(!0);try{const t=await axios.get(API_URL+"/settings/timezone_offset_hours");if(s(t.data.setting_value),e){try{const e=await axios.get(API_URL+"/settings/company_title");e.data.setting_value&&w(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/company_subtitle");e.data.setting_value&&_(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/company_address");e.data.setting_value&&L(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/ai_custom_context");e.data.setting_value&&K(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/messenger_app_name");e.data.setting_value&&ae(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/app_base_url");e.data.value?me(e.data.value):me(window.location.origin)}catch(e){me(window.location.origin)}try{const e=await axios.get(API_URL+"/settings/webhook_url");e.data.setting_value&&Ee(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/rate_limit_enabled");_e("true"===e.data.setting_value)}catch(e){_e(!1)}try{const e=await axios.get(API_URL+"/settings/placeholders");e.data&&Ae(e.data)}catch(e){}}}catch(e){}finally{n(!1)}},[We,Be]=React.useState(!1);return e?React.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[10000] p-4 backdrop-blur-sm",onClick:t},React.createElement("div",{className:"bg-white rounded-lg border border-gray-300 max-w-2xl w-full max-h-[85vh] sm:max-h-[90vh] overflow-hidden",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-purple-50"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2"},React.createElement("i",{className:"fas fa-cog"}),"Paramètres Système"),React.createElement("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 text-2xl",type:"button"},"×"))),React.createElement("div",{className:"p-6 overflow-y-auto",style:{maxHeight:"calc(90vh - 180px)"}},l?React.createElement("div",{className:"text-center py-8"},React.createElement("i",{className:"fas fa-spinner fa-spin text-3xl text-blue-600"})):React.createElement("div",{className:"space-y-6"},React.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-info-circle text-blue-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-blue-900 mb-2"},"À propos du décalage horaire"),React.createElement("p",{className:"text-sm text-blue-800 mb-2"},"Le décalage horaire permet d'ajuster l'heure du serveur pour correspondre à votre fuseau horaire local."),React.createElement("ul",{className:"text-sm text-blue-800 space-y-1 list-disc list-inside"},React.createElement("li",{},"Hiver (EST): -5 heures"),React.createElement("li",{},"Ete (EDT): -4 heures"),React.createElement("li",{},"Impacte: alertes retard, countdowns"))))),React.createElement("div",{},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-clock mr-2"}),"Decalage horaire (heures par rapport a UTC)"),React.createElement("select",{value:r,onChange:e=>s(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg font-semibold"},React.createElement("option",{value:"-12"},"UTC-12"),React.createElement("option",{value:"-11"},"UTC-11"),React.createElement("option",{value:"-10"},"UTC-10 (Hawaii)"),React.createElement("option",{value:"-9"},"UTC-9 (Alaska)"),React.createElement("option",{value:"-8"},"UTC-8 (PST)"),React.createElement("option",{value:"-7"},"UTC-7 (MST)"),React.createElement("option",{value:"-6"},"UTC-6 (CST)"),React.createElement("option",{value:"-5"},"UTC-5 (EST - Hiver Quebec)"),React.createElement("option",{value:"-4"},"UTC-4 (EDT - Ete Quebec)"),React.createElement("option",{value:"-3"},"UTC-3"),React.createElement("option",{value:"-2"},"UTC-2"),React.createElement("option",{value:"-1"},"UTC-1"),React.createElement("option",{value:"0"},"UTC+0 (Londres)"),React.createElement("option",{value:"1"},"UTC+1 (Paris)"),React.createElement("option",{value:"2"},"UTC+2"),React.createElement("option",{value:"3"},"UTC+3"),React.createElement("option",{value:"4"},"UTC+4"),React.createElement("option",{value:"5"},"UTC+5"),React.createElement("option",{value:"6"},"UTC+6"),React.createElement("option",{value:"7"},"UTC+7"),React.createElement("option",{value:"8"},"UTC+8 (Hong Kong)"),React.createElement("option",{value:"9"},"UTC+9 (Tokyo)"),React.createElement("option",{value:"10"},"UTC+10 (Sydney)"),React.createElement("option",{value:"11"},"UTC+11"),React.createElement("option",{value:"12"},"UTC+12"),React.createElement("option",{value:"13"},"UTC+13"),React.createElement("option",{value:"14"},"UTC+14")),React.createElement("p",{className:"mt-2 text-sm text-gray-600"},"Actuellement selectionne: UTC",r," (",-5===parseInt(r)?"EST - Hiver Quebec":-4===parseInt(r)?"EDT - Ete Quebec":"Personnalise",")")),React.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-exclamation-triangle text-yellow-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-yellow-900 mb-1"},"Attention"),React.createElement("p",{className:"text-sm text-yellow-800"},"Changez ce paramètre uniquement lors du changement d'heure (mars et novembre).")))),R&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-shield-alt text-red-600 text-xl mt-1"}),React.createElement("div",{className:"flex-1"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("div",{},React.createElement("h3",{className:"font-bold text-red-900 mb-1 flex items-center gap-2"},"Protection Anti-Abus",React.createElement("span",{className:"text-xs bg-red-600 text-white px-2 py-0.5 rounded"},"VENDEUR"),React.createElement("span",{className:"text-xs px-2 py-0.5 rounded "+(Ce?"bg-green-600 text-white":"bg-gray-400 text-white")},Ce?"ACTIVÉ":"DÉSACTIVÉ")),React.createElement("p",{className:"text-sm text-red-800"},Ce?"Limite les tentatives de connexion et les appels API pour protéger contre les attaques.":"Désactivé pour le développement. Activer pour la production.")),React.createElement("button",{onClick:async()=>{const e=!Ce;Le(!0);try{await axios.put(API_URL+"/settings/rate_limit_enabled",{value:e?"true":"false"}),_e(e),alert(e?"Protection anti-abus ACTIVÉE":"Protection anti-abus DÉSACTIVÉE")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{Le(!1)}},disabled:Ue,className:"ml-4 px-4 py-2 rounded-lg font-bold text-sm transition shadow-sm flex items-center gap-2 "+(Ce?"bg-gray-500 hover:bg-gray-600 text-white":"bg-green-600 hover:bg-green-700 text-white")},Ue&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),Ce?"Désactiver":"Activer")))))),v&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-teal-50 border border-teal-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-industry text-teal-600 text-xl mt-1"}),React.createElement("div",{className:"flex-1"},React.createElement("h3",{className:"font-bold text-teal-900 mb-2 flex items-center gap-2"},"Exemples des formulaires",React.createElement("span",{className:"text-xs bg-teal-600 text-white px-2 py-1 rounded"},"ADMIN")),React.createElement("p",{className:"text-sm text-teal-800 mb-3"},"Personnalisez les textes d'aide affichés dans les formulaires de création de machines et de tickets."),ke?React.createElement("div",{className:"space-y-3 bg-white rounded-lg p-4 border border-teal-200"},React.createElement("div",{},React.createElement("label",{className:"block text-xs font-semibold text-gray-600 mb-1"},"Type d'équipement"),React.createElement("input",{type:"text",value:Ie.placeholder_machine_type||"",onChange:e=>Pe({...Ie,placeholder_machine_type:e.target.value}),placeholder:"Ex: Équipement, Machine CNC, Véhicule...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-teal-500 text-sm",disabled:je})),React.createElement("div",{},React.createElement("label",{className:"block text-xs font-semibold text-gray-600 mb-1"},"Emplacement"),React.createElement("input",{type:"text",value:Ie.placeholder_location||"",onChange:e=>Pe({...Ie,placeholder_location:e.target.value}),placeholder:"Ex: Zone A, Atelier, Entrepôt...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-teal-500 text-sm",disabled:je})),React.createElement("div",{},React.createElement("label",{className:"block text-xs font-semibold text-gray-600 mb-1"},"Fabricant / Marque"),React.createElement("input",{type:"text",value:Ie.placeholder_manufacturer||"",onChange:e=>Pe({...Ie,placeholder_manufacturer:e.target.value}),placeholder:"Ex: Marque, Fabricant...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-teal-500 text-sm",disabled:je})),React.createElement("div",{className:"flex justify-end gap-2 pt-2"},React.createElement("button",{onClick:()=>{Te(!1),Pe({})},disabled:je,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{De(!0);try{await axios.put(API_URL+"/settings/placeholders",Ie,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),Ae(Ie),Te(!1),alert("Exemples mis à jour avec succès !")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{De(!1)}},disabled:je,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50",type:"button"},je&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),je?"Enregistrement...":"Enregistrer"))):React.createElement("div",{className:"space-y-2"},React.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm"},React.createElement("div",{className:"bg-white rounded p-2 border border-teal-100"},React.createElement("span",{className:"text-gray-500"},"Type: "),React.createElement("span",{className:"font-medium"},Se.placeholder_machine_type||"Non défini")),React.createElement("div",{className:"bg-white rounded p-2 border border-teal-100"},React.createElement("span",{className:"text-gray-500"},"Lieu: "),React.createElement("span",{className:"font-medium"},Se.placeholder_location||"Non défini")),React.createElement("div",{className:"bg-white rounded p-2 border border-teal-100"},React.createElement("span",{className:"text-gray-500"},"Fabricant: "),React.createElement("span",{className:"font-medium"},Se.placeholder_manufacturer||"Non défini"))),React.createElement("button",{onClick:()=>{Pe({...Se}),Te(!0)},className:"mt-3 px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Personnaliser les exemples")))))),R&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-broom text-orange-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-orange-900 mb-2 flex items-center gap-2"},"Maintenance Base de Données",React.createElement("span",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded"},"VENDEUR")),React.createElement("p",{className:"text-sm text-orange-800 mb-2"},"Nettoyage manuel des données obsolètes (Le Concierge)."),React.createElement("button",{onClick:async()=>{if(confirm("Lancer le nettoyage manuel ?\n\nCela supprimera :\n- Événements > 3 mois\n- Notes terminées > 30 jours\n- Et optimisera la base de données.")){Be(!0);try{const e=await axios.post(API_URL+"/settings/trigger-cleanup");alert("Nettoyage terminé avec succès !\n\n"+JSON.stringify(e.data.deleted,null,2))}catch(e){alert("Erreur ou fonction non disponible: "+(e.response?.data?.error||e.message))}finally{Be(!1)}}},disabled:We,className:"mt-2 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-bold text-sm transition shadow-sm flex items-center gap-2 disabled:opacity-50"},We&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),We?"Nettoyage...":"Lancer le nettoyage maintenant"))))),R&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-globe text-indigo-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-indigo-900 mb-2 flex items-center gap-2"},"Domaine & URL Système",React.createElement("span",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded"},"VENDEUR")),React.createElement("p",{className:"text-sm text-indigo-800 mb-2"},"Définit l'URL de base utilisée par l'Expert et les notifications pour générer des liens.")))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-link mr-2"}),"URL de base (Base URL)"),de?React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex gap-2"},React.createElement("input",{type:"text",value:pe,onChange:e=>ge(e.target.value),placeholder:"https://votre-domaine.com",className:"flex-1 px-4 py-2.5 border-2 border-indigo-300 rounded-lg focus:outline-none focus:border-indigo-500 font-mono text-sm",disabled:be}),React.createElement("button",{onClick:()=>{ge(window.location.origin)},className:"px-3 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-semibold text-sm whitespace-nowrap",title:"Auto-détecter l'URL actuelle",type:"button"},React.createElement("i",{className:"fas fa-magic"})," Auto")),React.createElement("div",{className:"flex items-center justify-end gap-2"},React.createElement("button",{onClick:()=>{ge(""),ue(!1)},disabled:be,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{let e=pe.trim();if(e){e.endsWith("/")&&(e=e.slice(0,-1)),e.startsWith("http://")||e.startsWith("https://")||(e="https://"+e),xe(!0);try{await axios.put(API_URL+"/settings/app_base_url",{value:e}),me(e),ue(!1),ge(""),alert("Domaine mis à jour avec succès !")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{xe(!1)}}else alert("L'URL ne peut pas être vide")},disabled:!pe.trim()||be,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},be&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),be?"Enregistrement...":"Enregistrer"))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800 font-mono text-sm"},oe||("undefined"!=typeof window?window.location.origin:"")),React.createElement("button",{onClick:()=>{ge(oe),ue(!0)},className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Configurer")))),R&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-teal-50 border border-teal-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-plug text-teal-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-teal-900 mb-2 flex items-center gap-2"},"Intégrations & Webhooks",React.createElement("span",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded"},"VENDEUR")),React.createElement("p",{className:"text-sm text-teal-800 mb-2"},"Connectez votre application à des services externes (Pabbly, Make, Zapier, n8n...)."),React.createElement("p",{className:"text-xs text-teal-700"},"Les événements (ticket créé, en retard, etc.) seront envoyés à cette URL.")))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-link mr-2"}),"URL du Webhook (laisser vide pour désactiver)"),Re?React.createElement("div",{className:"space-y-3"},React.createElement("input",{type:"text",value:ve,onChange:e=>Ne(e.target.value),placeholder:"https://connect.pabbly.com/workflow/... ou https://hook.make.com/...",className:"w-full px-4 py-2.5 border-2 border-teal-300 rounded-lg focus:outline-none focus:border-teal-500 font-mono text-sm",disabled:he}),React.createElement("div",{className:"flex items-center justify-end gap-2"},React.createElement("button",{onClick:()=>{Ne(""),ye(!1)},disabled:he,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{let e=ve.trim();!e||e.startsWith("http://")||e.startsWith("https://")||(e="https://"+e),we(!0);try{await axios.put(API_URL+"/settings/webhook_url",{value:e}),Ee(e),ye(!1),Ne(""),alert(e?"Webhook configuré avec succès !":"Webhook désactivé.")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{we(!1)}},disabled:he,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50",type:"button"},he&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),he?"Enregistrement...":"Enregistrer"))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800 font-mono text-sm truncate"},fe||React.createElement("span",{className:"text-gray-500 italic"},"Non configuré (notifications désactivées)")),React.createElement("button",{onClick:()=>{Ne(fe),ye(!0)},className:"px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Configurer")))),v&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-image text-purple-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-purple-900 mb-2 flex items-center gap-2"},"Logo de l'entreprise",React.createElement("span",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded"},"ADMIN")),React.createElement("p",{className:"text-sm text-purple-800 mb-2"},"Personnalisez le logo affiché dans l'application."),React.createElement("ul",{className:"text-sm text-purple-800 space-y-1 list-disc list-inside"},React.createElement("li",{},"Format: PNG transparent recommandé"),React.createElement("li",{},"Dimensions: 200×80 pixels (ratio 2.5:1)"),React.createElement("li",{},"Taille max: 500 KB"))))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-eye mr-2"}),"Logo actuel"),React.createElement("div",{className:"bg-gray-100 border-2 border-gray-300 rounded-lg p-4 flex items-center justify-center"},React.createElement("img",{src:b+"?t="+f,alt:"Logo actuel",className:"max-h-20 max-w-full object-contain",onError:e=>{e.target.src="/logo.png"}}))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-upload mr-2"}),"Uploader un nouveau logo"),React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("label",{className:"cursor-pointer px-4 py-2 bg-purple-100 hover:bg-purple-200 text-purple-700 font-semibold rounded-lg border-2 border-purple-300 transition-all flex items-center gap-2 "+(p?"opacity-50 cursor-not-allowed":""),style:{pointerEvents:p?"none":"auto"}},React.createElement("i",{className:"fas fa-folder-open"}),React.createElement("span",{},"Choisir un fichier"),React.createElement("input",{type:"file",accept:"image/png,image/jpeg,image/jpg,image/webp",onChange:e=>{const t=e.target.files?.[0];if(!t)return;if(!["image/png","image/jpeg","image/jpg","image/webp"].includes(t.type))return void alert("Type de fichier non autorisé. Utilisez PNG, JPEG ou WEBP.");if(t.size>512e3)return void alert("Fichier trop volumineux ("+(t.size/1024).toFixed(0)+" KB). Maximum: 500 KB");m(t);const a=new FileReader;a.onloadend=()=>{u(a.result)},a.readAsDataURL(t)},disabled:p,className:"hidden"})),React.createElement("span",{className:"text-sm text-gray-600"},o?o.name:"Aucun fichier sélectionné")),d&&React.createElement("div",{className:"mt-3 bg-white border-2 border-purple-300 rounded-lg p-3 sm:p-4"},React.createElement("p",{className:"text-sm font-semibold text-gray-700 mb-2"},"Aperçu:"),React.createElement("div",{className:"flex items-center justify-center"},React.createElement("img",{src:d,alt:"Aperçu",className:"max-h-20 max-w-full object-contain"})))),React.createElement("div",{className:"flex flex-col sm:flex-row gap-3"},React.createElement("button",{onClick:async()=>{if(o){g(!0);try{const e=new FormData;e.append("logo",o);await axios.post(API_URL+"/settings/upload-logo",e,{headers:{"Content-Type":"multipart/form-data"}});E(Date.now()),m(null),u(null),alert("Logo uploadé avec succès! La page va se recharger pour afficher le nouveau logo..."),setTimeout(()=>{window.location.reload()},1500)}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur")),g(!1)}}else alert("Veuillez sélectionner un fichier")},disabled:!o||p,className:"flex-1 px-4 py-2.5 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-semibold transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",type:"button"},p&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),p?"Upload en cours...":"Uploader le logo"),React.createElement("button",{onClick:async()=>{if(confirm("Voulez-vous vraiment réinitialiser le logo au logo par défaut?")){g(!0);try{await axios.delete(API_URL+"/settings/logo"),E(Date.now()),m(null),u(null),alert("Logo réinitialisé avec succès! La page va se recharger pour afficher le logo par défaut..."),setTimeout(()=>{window.location.reload()},1500)}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur")),g(!1)}}},disabled:p,className:"px-4 py-2.5 bg-red-500 hover:bg-red-600 text-white rounded-lg font-semibold transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",type:"button",title:"Réinitialiser au logo par défaut"},React.createElement("i",{className:"fas fa-undo"}),React.createElement("span",{className:"hidden sm:inline"},"Réinitialiser"),React.createElement("span",{className:"sm:hidden"},"Reset")))),v&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-heading text-blue-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-blue-900 mb-2 flex items-center gap-2"},"Personnalisation de l'Interface",React.createElement("span",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded"},"ADMIN")),React.createElement("p",{className:"text-sm text-blue-800 mb-2"},"Personnalisez les titres et noms affichés dans l'application.")))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-heading mr-2"}),"Titre principal"),S?React.createElement("div",{className:"space-y-3"},React.createElement("input",{type:"text",value:j,onChange:e=>D(e.target.value),placeholder:"Entrez le nouveau titre",maxLength:100,className:"w-full px-4 py-2.5 border-2 border-blue-300 rounded-lg focus:outline-none focus:border-blue-500",disabled:F}),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs text-gray-600"},j.length+"/100 caractères"),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{D(""),A(!1)},disabled:F,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{if(j.trim())if(j.trim().length>100)alert("Le titre ne peut pas dépasser 100 caractères");else{O(!0);try{await axios.put(API_URL+"/settings/title",{value:j.trim()}),w(j.trim()),A(!1),D(""),alert("Titre mis à jour avec succès! La page va se recharger..."),setTimeout(()=>{window.location.reload()},1500)}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{O(!1)}}else alert("Le titre ne peut pas être vide")},disabled:!j.trim()||F,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},F&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),F?"Enregistrement...":"Enregistrer")))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800"},h),React.createElement("button",{onClick:()=>{D(h),A(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Modifier"))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-align-left mr-2"}),"Sous-titre"),k?React.createElement("div",{className:"space-y-3"},React.createElement("input",{type:"text",value:M,onChange:e=>z(e.target.value),placeholder:"Entrez le nouveau sous-titre",maxLength:150,className:"w-full px-4 py-2.5 border-2 border-blue-300 rounded-lg focus:outline-none focus:border-blue-500",disabled:W}),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs text-gray-600"},M.length+"/150 caractères"),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{z(""),T(!1)},disabled:W,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{if(M.trim())if(M.trim().length>150)alert("Le sous-titre ne peut pas dépasser 150 caractères");else{B(!0);try{await axios.put(API_URL+"/settings/subtitle",{value:M.trim()}),_(M.trim()),T(!1),z(""),alert("Sous-titre mis à jour avec succès! La page va se recharger..."),setTimeout(()=>{window.location.reload()},1500)}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{B(!1)}}else alert("Le sous-titre ne peut pas être vide")},disabled:!M.trim()||W,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},W&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),W?"Enregistrement...":"Enregistrer")))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800"},C),React.createElement("button",{onClick:()=>{z(C),T(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Modifier"))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-map-marker-alt mr-2"}),"Adresse de l'entreprise (pour impression)"),I?React.createElement("div",{className:"space-y-3"},React.createElement("input",{type:"text",value:q,onChange:e=>V(e.target.value),placeholder:"Ex: 9150 Bd Maurice-Duplessis, Montréal, QC H1E 7C2",maxLength:200,className:"w-full px-4 py-2.5 border-2 border-blue-300 rounded-lg focus:outline-none focus:border-blue-500",disabled:H}),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs text-gray-600"},q.length+"/200 caractères"),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{V(""),P(!1)},disabled:H,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{if(q.trim().length>200)alert("L'adresse ne peut pas dépasser 200 caractères");else{G(!0);try{await axios.put(API_URL+"/settings/company_address",{value:q.trim()}),L(q.trim()),P(!1),V(""),alert("Adresse mise à jour avec succès!")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{G(!1)}}},disabled:H,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},H&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),H?"Enregistrement...":"Enregistrer")))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800"},U||React.createElement("span",{className:"text-gray-400 italic"},"Non configurée")),React.createElement("button",{onClick:()=>{V(U),P(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Modifier"))),React.createElement("div",{className:"mb-0"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-comments mr-2"}),'Nom du bouton "Connect" (Messagerie externe)'),re?React.createElement("div",{className:"space-y-3"},React.createElement("input",{type:"text",value:le,onChange:e=>ne(e.target.value),placeholder:"Ex: Connect, Ma Messagerie...",maxLength:50,className:"w-full px-4 py-2.5 border-2 border-blue-300 rounded-lg focus:outline-none focus:border-blue-500",disabled:ce}),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs text-gray-600"},le.length+"/50 caractères"),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{ne(""),se(!1)},disabled:ce,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{if(le.trim())if(le.length>50)alert("Le nom ne peut pas dépasser 50 caractères");else{ie(!0);try{await axios.put(API_URL+"/settings/messenger_app_name",{value:le.trim()}),ae(le.trim()),se(!1),ne(""),alert("Nom de l'application messagerie mis à jour ! La page va se recharger..."),setTimeout(()=>{window.location.reload()},1500)}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{ie(!1)}}else alert("Le nom ne peut pas être vide")},disabled:!le.trim()||ce,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},ce&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),ce?"Enregistrement...":"Enregistrer")))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800"},te),React.createElement("button",{onClick:()=>{ne(te),se(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Modifier")))),v&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-user-tie text-green-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-green-900 mb-2 flex items-center gap-2"},"Configuration de l'Expert",React.createElement("span",{className:"text-xs bg-purple-600 text-white px-2 py-1 rounded"},"NOUVEAU")),React.createElement("p",{className:"text-sm text-green-800 mb-2"},"Configurez l'identité, le caractère et les connaissances techniques de votre Expert."),React.createElement("div",{className:"mt-3"},React.createElement("a",{href:"/admin/ai-settings",className:"inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-bold text-sm transition shadow-sm gap-2",target:"_self"},React.createElement("i",{className:"fas fa-sliders-h"}),"Ouvrir le Configurateur Avancé"))))),React.createElement("details",{className:"mb-0 group"},React.createElement("summary",{className:"cursor-pointer text-sm font-semibold text-gray-500 hover:text-gray-700 mb-2 flex items-center select-none"},React.createElement("i",{className:"fas fa-chevron-right mr-2 transition-transform group-open:rotate-90"}),"Voir l'ancien éditeur de contexte (Legacy)"),React.createElement("div",{className:"pl-4 border-l-2 border-gray-200 mt-2"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-file-alt mr-2"}),"Prompt Principal & Contexte"),Z?React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex justify-end"},React.createElement("button",{onClick:()=>Y("RÔLE : Expert Industriel Senior\n\nMISSION :\nAssister les techniciens et administrateurs dans la maintenance, le diagnostic de pannes et l'optimisation de la production.\n\nRÈGLES D'OR :\n1. SÉCURITÉ AVANT TOUT : Rappeler systématiquement les procédures de sécurité avant toute intervention.\n2. CONTEXTE INDUSTRIEL : Se concentrer uniquement sur les machines, la maintenance, la production et la sécurité.\n3. TON PROFESSIONNEL : Être direct, précis et factuel.\n\nCONTEXTE :\n- Nous sommes une entreprise de production industrielle.\n- Les équipements critiques doivent être maintenus en priorité.\n- La production fonctionne en continu."),className:"text-xs text-blue-600 hover:text-blue-800 underline",type:"button"},"Charger le modèle par défaut")),React.createElement("textarea",{value:X,onChange:e=>Y(e.target.value),placeholder:"Ex: Nous sommes une usine de fabrication de verre. Les machines critiques sont les Fours et les CNC. La sécurité est la priorité absolue.",maxLength:3e4,rows:6,className:"w-full px-4 py-2.5 border-2 border-blue-300 rounded-lg focus:outline-none focus:border-blue-500",disabled:$}),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs text-gray-600"},X.length+"/30000 caractères"),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{Y(""),J(!1)},disabled:$,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{if(X.length>3e4)alert("Le contexte AI ne peut pas dépasser 30000 caractères");else{ee(!0);try{await axios.put(API_URL+"/settings/ai_custom_context",{value:X.trim()}),K(X.trim()),J(!1),Y(""),alert("Contexte AI mis à jour avec succès!")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{ee(!1)}}},disabled:$,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},$&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),$?"Enregistrement...":"Enregistrer")))):React.createElement("div",{className:"flex flex-col gap-3"},React.createElement("div",{className:"bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800 whitespace-pre-wrap min-h-[60px] text-sm font-mono"},Q||React.createElement("div",{className:"text-gray-500 italic"},React.createElement("p",{className:"font-bold mb-1"},"Prompt par défaut actif :"),"RÔLE : Expert Industriel Senior...",React.createElement("br"),"(Cliquez sur Modifier pour voir ou personnaliser le prompt complet)")),React.createElement("button",{onClick:()=>{Y(Q),J(!0)},className:"self-start px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Modifier (Legacy)")))))),React.createElement("div",{className:"p-6 border-t border-gray-200 bg-gray-50 flex justify-end gap-3"},React.createElement("button",{onClick:t,disabled:c,className:"px-6 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{i(!0);try{await axios.put(API_URL+"/settings/timezone_offset_hours",{value:r}),localStorage.setItem("timezone_offset_hours",r),alert("Paramètres mis à jour avec succès!"),t()}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{i(!1)}},disabled:c,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2",type:"button"},c&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),c?"Enregistrement...":"Enregistrer"))))):null};