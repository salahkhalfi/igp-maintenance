const SystemSettingsModal=({show:e,onClose:t,currentUser:a})=>{const[r,s]=React.useState("-5"),[l,n]=React.useState(!0),[c,i]=React.useState(!1),[o,m]=React.useState(null),[d,u]=React.useState(null),[p,g]=React.useState(!1),[b,x]=React.useState("/api/settings/logo"),[f,R]=React.useState(Date.now()),[E,y]=React.useState(!1),[N,v]=React.useState(!1),[h,w]=React.useState("Système de Gestion Interne"),[C,_]=React.useState(""),[S,A]=React.useState(""),[U,L]=React.useState(""),[k,I]=React.useState(""),[T,P]=React.useState(!1),[j,D]=React.useState(!1),[M,z]=React.useState(!1),[V,F]=React.useState(!1),[q,G]=React.useState(!1),[O,B]=React.useState(""),[W,H]=React.useState(""),[K,Q]=React.useState(""),[J,$]=React.useState(""),[Z,X]=React.useState(""),[Y,ee]=React.useState(!1),[te,ae]=React.useState(!1),[re,se]=React.useState(!1),[le,ne]=React.useState(!1),[ce,ie]=React.useState(!1),[oe,me]=React.useState(""),[de,ue]=React.useState(!1),[pe,ge]=React.useState(""),[be,xe]=React.useState(!1),[fe,Re]=React.useState("Connect"),[Ee,ye]=React.useState(!1),[Ne,ve]=React.useState(""),[he,we]=React.useState(!1),[Ce,_e]=React.useState(""),[Se,Ae]=React.useState(!1),[Ue,Le]=React.useState(""),[ke,Ie]=React.useState(!1),[Te,Pe]=React.useState(""),[je,De]=React.useState(!1),[Me,ze]=React.useState(""),[Ve,Fe]=React.useState(!1),[qe,Ge]=React.useState(!1),[Oe,Be]=React.useState(!1),[We,He]=React.useState(!1),[Ke,Qe]=React.useState(null),[Je,$e]=React.useState({placeholder_machine_type:"Ex: Équipement, Machine...",placeholder_location:"Ex: Zone A, Atelier...",placeholder_manufacturer:"Ex: Marque, Fabricant..."}),[Ze,Xe]=React.useState(!1),[Ye,et]=React.useState({}),[tt,at]=React.useState(!1),[rt,st]=React.useState(null),[lt,nt]=React.useState(null),[ct,it]=React.useState(!1),[ot,mt]=React.useState(null),[dt,ut]=React.useState(Date.now()),[pt,gt]=React.useState(!1),[bt,xt]=React.useState({planning:!0,statistics:!0,notifications:!0,messaging:!0,machines:!0}),[ft,Rt]=React.useState({planning:!0,statistics:!0,notifications:!0,messaging:!0,machines:!0});React.useEffect(()=>{e&&(async()=>{let e=!1,t=!1;a&&(!0===a.isSuperAdmin?(e=!0,t=!0):"admin"===a.role&&(t=!0)),y(e),v(t),await yt(t),Et(),t&&Nt()})()},[e,a]);const Et=async()=>{try{const e=await axios.get(API_URL+"/settings/modules/status");xt(e.data);const t=await axios.get(API_URL+"/settings/modules/preferences");Rt(t.data)}catch(e){console.error(e)}},yt=async e=>{n(!0);try{const t=await axios.get(API_URL+"/settings/timezone_offset_hours");if(s(t.data.setting_value),e){try{const e=await axios.get(API_URL+"/settings/company_title");e.data.setting_value&&w(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/company_name");e.data.setting_value&&_(e.data.setting_value)}catch(e){}if(!C)try{const e=await axios.get(API_URL+"/settings/company_subtitle");e.data.setting_value&&_(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/company_address");e.data.setting_value&&A(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/company_email");e.data.setting_value&&L(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/company_phone");e.data.setting_value&&I(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/ai_custom_context");e.data.setting_value&&me(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/messenger_app_name");e.data.setting_value&&Re(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/app_base_url");e.data.value?_e(e.data.value):_e(window.location.origin)}catch(e){_e(window.location.origin)}try{const e=await axios.get(API_URL+"/settings/webhook_url");e.data.setting_value&&Pe(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/rate_limit_enabled");Ge("true"===e.data.setting_value)}catch(e){Ge(!1)}try{const e=await axios.get(API_URL+"/settings/placeholders");e.data&&$e(e.data)}catch(e){}}}catch(e){}finally{n(!1)}},Nt=async()=>{if(a?.id)try{const e=await axios.get(API_URL+"/settings/signature/"+a.id);e.data&&e.data.base64?(mt("data:"+(e.data.mimeType||"image/png")+";base64,"+e.data.base64),gt(!0)):(gt(!1),mt(null))}catch(e){gt(!1),mt(null)}},[vt,ht]=React.useState(!1);return e?React.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[10000] p-4 backdrop-blur-sm",onClick:t},React.createElement("div",{className:"bg-white rounded-lg border border-gray-300 max-w-2xl w-full max-h-[85vh] sm:max-h-[90vh] overflow-hidden",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-purple-50"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2"},React.createElement("i",{className:"fas fa-cog"}),"Paramètres Système"),React.createElement("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 text-2xl",type:"button"},"×"))),React.createElement("div",{className:"p-6 overflow-y-auto",style:{maxHeight:"calc(90vh - 180px)"}},l?React.createElement("div",{className:"text-center py-8"},React.createElement("i",{className:"fas fa-spinner fa-spin text-3xl text-blue-600"})):React.createElement("div",{className:"space-y-6"},React.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-info-circle text-blue-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-blue-900 mb-2"},"À propos du décalage horaire"),React.createElement("p",{className:"text-sm text-blue-800 mb-2"},"Le décalage horaire permet d'ajuster l'heure du serveur pour correspondre à votre fuseau horaire local."),React.createElement("ul",{className:"text-sm text-blue-800 space-y-1 list-disc list-inside"},React.createElement("li",{},"Hiver (EST): -5 heures"),React.createElement("li",{},"Ete (EDT): -4 heures"),React.createElement("li",{},"Impacte: alertes retard, countdowns"))))),React.createElement("div",{},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-clock mr-2"}),"Decalage horaire (heures par rapport a UTC)"),React.createElement("select",{value:r,onChange:e=>s(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg font-semibold"},React.createElement("option",{value:"-12"},"UTC-12"),React.createElement("option",{value:"-11"},"UTC-11"),React.createElement("option",{value:"-10"},"UTC-10 (Hawaii)"),React.createElement("option",{value:"-9"},"UTC-9 (Alaska)"),React.createElement("option",{value:"-8"},"UTC-8 (PST)"),React.createElement("option",{value:"-7"},"UTC-7 (MST)"),React.createElement("option",{value:"-6"},"UTC-6 (CST)"),React.createElement("option",{value:"-5"},"UTC-5 (EST - Hiver Quebec)"),React.createElement("option",{value:"-4"},"UTC-4 (EDT - Ete Quebec)"),React.createElement("option",{value:"-3"},"UTC-3"),React.createElement("option",{value:"-2"},"UTC-2"),React.createElement("option",{value:"-1"},"UTC-1"),React.createElement("option",{value:"0"},"UTC+0 (Londres)"),React.createElement("option",{value:"1"},"UTC+1 (Paris)"),React.createElement("option",{value:"2"},"UTC+2"),React.createElement("option",{value:"3"},"UTC+3"),React.createElement("option",{value:"4"},"UTC+4"),React.createElement("option",{value:"5"},"UTC+5"),React.createElement("option",{value:"6"},"UTC+6"),React.createElement("option",{value:"7"},"UTC+7"),React.createElement("option",{value:"8"},"UTC+8 (Hong Kong)"),React.createElement("option",{value:"9"},"UTC+9 (Tokyo)"),React.createElement("option",{value:"10"},"UTC+10 (Sydney)"),React.createElement("option",{value:"11"},"UTC+11"),React.createElement("option",{value:"12"},"UTC+12"),React.createElement("option",{value:"13"},"UTC+13"),React.createElement("option",{value:"14"},"UTC+14")),React.createElement("p",{className:"mt-2 text-sm text-gray-600"},"Actuellement selectionne: UTC",r," (",-5===parseInt(r)?"EST - Hiver Quebec":-4===parseInt(r)?"EDT - Ete Quebec":"Personnalise",")")),React.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-exclamation-triangle text-yellow-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-yellow-900 mb-1"},"Attention"),React.createElement("p",{className:"text-sm text-yellow-800"},"Changez ce paramètre uniquement lors du changement d'heure (mars et novembre).")))),E&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-shield-alt text-red-600 text-xl mt-1"}),React.createElement("div",{className:"flex-1"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("div",{},React.createElement("h3",{className:"font-bold text-red-900 mb-1 flex items-center gap-2"},"Protection Anti-Abus",React.createElement("span",{className:"text-xs bg-red-600 text-white px-2 py-0.5 rounded"},"VENDEUR"),React.createElement("span",{className:"text-xs px-2 py-0.5 rounded "+(qe?"bg-green-600 text-white":"bg-gray-400 text-white")},qe?"ACTIVÉ":"DÉSACTIVÉ")),React.createElement("p",{className:"text-sm text-red-800"},qe?"Limite les tentatives de connexion et les appels API pour protéger contre les attaques.":"Désactivé pour le développement. Activer pour la production.")),React.createElement("button",{onClick:async()=>{const e=!qe;Be(!0);try{await axios.put(API_URL+"/settings/rate_limit_enabled",{value:e?"true":"false"}),Ge(e),alert(e?"Protection anti-abus ACTIVÉE":"Protection anti-abus DÉSACTIVÉE")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{Be(!1)}},disabled:Oe,className:"ml-4 px-4 py-2 rounded-lg font-bold text-sm transition shadow-sm flex items-center gap-2 "+(qe?"bg-gray-500 hover:bg-gray-600 text-white":"bg-green-600 hover:bg-green-700 text-white")},Oe&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),qe?"Désactiver":"Activer")))))),N&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-teal-50 border border-teal-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-industry text-teal-600 text-xl mt-1"}),React.createElement("div",{className:"flex-1"},React.createElement("h3",{className:"font-bold text-teal-900 mb-2 flex items-center gap-2"},"Exemples des formulaires",React.createElement("span",{className:"text-xs bg-teal-600 text-white px-2 py-1 rounded"},"ADMIN")),React.createElement("p",{className:"text-sm text-teal-800 mb-3"},"Personnalisez les textes d'aide affichés dans les formulaires de création de machines et de tickets."),Ze?React.createElement("div",{className:"space-y-3 bg-white rounded-lg p-4 border border-teal-200"},React.createElement("div",{},React.createElement("label",{className:"block text-xs font-semibold text-gray-600 mb-1"},"Type d'équipement"),React.createElement("input",{type:"text",value:Ye.placeholder_machine_type||"",onChange:e=>et({...Ye,placeholder_machine_type:e.target.value}),placeholder:"Ex: Équipement, Machine CNC, Véhicule...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-teal-500 text-sm",disabled:tt})),React.createElement("div",{},React.createElement("label",{className:"block text-xs font-semibold text-gray-600 mb-1"},"Emplacement"),React.createElement("input",{type:"text",value:Ye.placeholder_location||"",onChange:e=>et({...Ye,placeholder_location:e.target.value}),placeholder:"Ex: Zone A, Atelier, Entrepôt...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-teal-500 text-sm",disabled:tt})),React.createElement("div",{},React.createElement("label",{className:"block text-xs font-semibold text-gray-600 mb-1"},"Fabricant / Marque"),React.createElement("input",{type:"text",value:Ye.placeholder_manufacturer||"",onChange:e=>et({...Ye,placeholder_manufacturer:e.target.value}),placeholder:"Ex: Marque, Fabricant...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-teal-500 text-sm",disabled:tt})),React.createElement("div",{className:"flex justify-end gap-2 pt-2"},React.createElement("button",{onClick:()=>{Xe(!1),et({})},disabled:tt,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{at(!0);try{await axios.put(API_URL+"/settings/placeholders",Ye,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),$e(Ye),Xe(!1),alert("Exemples mis à jour avec succès !")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{at(!1)}},disabled:tt,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50",type:"button"},tt&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),tt?"Enregistrement...":"Enregistrer"))):React.createElement("div",{className:"space-y-2"},React.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm"},React.createElement("div",{className:"bg-white rounded p-2 border border-teal-100"},React.createElement("span",{className:"text-gray-500"},"Type: "),React.createElement("span",{className:"font-medium"},Je.placeholder_machine_type||"Non défini")),React.createElement("div",{className:"bg-white rounded p-2 border border-teal-100"},React.createElement("span",{className:"text-gray-500"},"Lieu: "),React.createElement("span",{className:"font-medium"},Je.placeholder_location||"Non défini")),React.createElement("div",{className:"bg-white rounded p-2 border border-teal-100"},React.createElement("span",{className:"text-gray-500"},"Fabricant: "),React.createElement("span",{className:"font-medium"},Je.placeholder_manufacturer||"Non défini"))),React.createElement("button",{onClick:()=>{et({...Je}),Xe(!0)},className:"mt-3 px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Personnaliser les exemples")))))),E&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-broom text-orange-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-orange-900 mb-2 flex items-center gap-2"},"Maintenance Base de Données",React.createElement("span",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded"},"VENDEUR")),React.createElement("p",{className:"text-sm text-orange-800 mb-2"},"Nettoyage manuel des données obsolètes (Le Concierge)."),React.createElement("button",{onClick:async()=>{if(confirm("Lancer le nettoyage manuel ?\n\nCela supprimera :\n- Événements > 3 mois\n- Notes terminées > 30 jours\n- Et optimisera la base de données.")){ht(!0);try{const e=await axios.post(API_URL+"/settings/trigger-cleanup");alert("Nettoyage terminé avec succès !\n\n"+JSON.stringify(e.data.deleted,null,2))}catch(e){alert("Erreur ou fonction non disponible: "+(e.response?.data?.error||e.message))}finally{ht(!1)}}},disabled:vt,className:"mt-2 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-bold text-sm transition shadow-sm flex items-center gap-2 disabled:opacity-50"},vt&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),vt?"Nettoyage...":"Lancer le nettoyage maintenant"))))),E&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-globe text-indigo-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-indigo-900 mb-2 flex items-center gap-2"},"Domaine & URL Système",React.createElement("span",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded"},"VENDEUR")),React.createElement("p",{className:"text-sm text-indigo-800 mb-2"},"Définit l'URL de base utilisée par l'Expert et les notifications pour générer des liens.")))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-link mr-2"}),"URL de base (Base URL)"),Se?React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex gap-2"},React.createElement("input",{type:"text",value:Ue,onChange:e=>Le(e.target.value),placeholder:"https://votre-domaine.com",className:"flex-1 px-4 py-2.5 border-2 border-indigo-300 rounded-lg focus:outline-none focus:border-indigo-500 font-mono text-sm",disabled:ke}),React.createElement("button",{onClick:()=>{Le(window.location.origin)},className:"px-3 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-semibold text-sm whitespace-nowrap",title:"Auto-détecter l'URL actuelle",type:"button"},React.createElement("i",{className:"fas fa-magic"})," Auto")),React.createElement("div",{className:"flex items-center justify-end gap-2"},React.createElement("button",{onClick:()=>{Le(""),Ae(!1)},disabled:ke,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{let e=Ue.trim();if(e){e.endsWith("/")&&(e=e.slice(0,-1)),e.startsWith("http://")||e.startsWith("https://")||(e="https://"+e),Ie(!0);try{await axios.put(API_URL+"/settings/app_base_url",{value:e}),_e(e),Ae(!1),Le(""),alert("Domaine mis à jour avec succès !")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{Ie(!1)}}else alert("L'URL ne peut pas être vide")},disabled:!Ue.trim()||ke,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},ke&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),ke?"Enregistrement...":"Enregistrer"))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800 font-mono text-sm"},Ce||("undefined"!=typeof window?window.location.origin:"")),React.createElement("button",{onClick:()=>{Le(Ce),Ae(!0)},className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Configurer")))),E&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-teal-50 border border-teal-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-plug text-teal-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-teal-900 mb-2 flex items-center gap-2"},"Intégrations & Webhooks",React.createElement("span",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded"},"VENDEUR")),React.createElement("p",{className:"text-sm text-teal-800 mb-2"},"Connectez votre application à des services externes (Pabbly, Make, Zapier, n8n...)."),React.createElement("p",{className:"text-xs text-teal-700"},"Les événements (ticket créé, en retard, etc.) seront envoyés à cette URL.")))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-link mr-2"}),"URL du Webhook (laisser vide pour désactiver)"),je?React.createElement("div",{className:"space-y-3"},React.createElement("input",{type:"text",value:Me,onChange:e=>ze(e.target.value),placeholder:"https://connect.pabbly.com/workflow/... ou https://hook.make.com/...",className:"w-full px-4 py-2.5 border-2 border-teal-300 rounded-lg focus:outline-none focus:border-teal-500 font-mono text-sm",disabled:Ve}),React.createElement("div",{className:"flex items-center justify-end gap-2"},React.createElement("button",{onClick:()=>{ze(""),De(!1)},disabled:Ve,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{let e=Me.trim();!e||e.startsWith("http://")||e.startsWith("https://")||(e="https://"+e),Fe(!0);try{await axios.put(API_URL+"/settings/webhook_url",{value:e}),Pe(e),De(!1),ze(""),alert(e?"Webhook configuré avec succès !":"Webhook désactivé.")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{Fe(!1)}},disabled:Ve,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50",type:"button"},Ve&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),Ve?"Enregistrement...":"Enregistrer"))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800 font-mono text-sm truncate"},Te||React.createElement("span",{className:"text-gray-500 italic"},"Non configuré (notifications désactivées)")),React.createElement("button",{onClick:()=>{ze(Te),De(!0)},className:"px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Configurer")))),N&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-broom text-orange-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-orange-900 mb-2 flex items-center gap-2"},"Maintenance",React.createElement("span",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded"},"ADMIN")),React.createElement("p",{className:"text-sm text-orange-800"},"Outils de maintenance pour nettoyer les données obsolètes.")))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-bell-slash mr-2"}),"Notifications orphelines"),React.createElement("p",{className:"text-sm text-gray-600 mb-3"},"Supprime les notifications en attente pour des tickets qui ont été supprimés."),React.createElement("div",{className:"flex items-center gap-4"},React.createElement("button",{onClick:async()=>{if(confirm("Voulez-vous nettoyer les notifications en attente pour des tickets supprimés ?")){He(!0),Qe(null);try{const e=await axios.delete(API_URL+"/push/cleanup-orphan-notifications");Qe(e.data),e.data.cleaned>0?alert(`Nettoyage terminé : ${e.data.cleaned} notification(s) orpheline(s) supprimée(s)`):alert("Aucune notification orpheline trouvée.")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{He(!1)}}},disabled:We,className:"px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50",type:"button"},We?React.createElement("i",{className:"fas fa-spinner fa-spin"}):React.createElement("i",{className:"fas fa-broom"}),We?"Nettoyage...":"Nettoyer"),Ke&&React.createElement("span",{className:"text-sm text-gray-600"},`Dernier nettoyage : ${Ke.cleaned} supprimée(s) sur ${Ke.total_pending} en attente`)))),N&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-image text-purple-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-purple-900 mb-2 flex items-center gap-2"},"Logo de l'entreprise",React.createElement("span",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded"},"ADMIN")),React.createElement("p",{className:"text-sm text-purple-800 mb-2"},"Personnalisez le logo affiché dans l'application."),React.createElement("ul",{className:"text-sm text-purple-800 space-y-1 list-disc list-inside"},React.createElement("li",{},"Format: PNG transparent recommandé"),React.createElement("li",{},"Dimensions: 200×80 pixels (ratio 2.5:1)"),React.createElement("li",{},"Taille max: 500 KB"))))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-eye mr-2"}),"Logo actuel"),React.createElement("div",{className:"bg-gray-100 border-2 border-gray-300 rounded-lg p-4 flex items-center justify-center"},React.createElement("img",{src:b+"?t="+f,alt:"Logo actuel",className:"max-h-20 max-w-full object-contain",onError:e=>{e.target.src="/logo.png"}}))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-upload mr-2"}),"Uploader un nouveau logo"),React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("label",{className:"cursor-pointer px-4 py-2 bg-purple-100 hover:bg-purple-200 text-purple-700 font-semibold rounded-lg border-2 border-purple-300 transition-all flex items-center gap-2 "+(p?"opacity-50 cursor-not-allowed":""),style:{pointerEvents:p?"none":"auto"}},React.createElement("i",{className:"fas fa-folder-open"}),React.createElement("span",{},"Choisir un fichier"),React.createElement("input",{type:"file",accept:"image/png,image/jpeg,image/jpg,image/webp",onChange:e=>{const t=e.target.files?.[0];if(!t)return;if(!["image/png","image/jpeg","image/jpg","image/webp"].includes(t.type))return void alert("Type de fichier non autorisé. Utilisez PNG, JPEG ou WEBP.");if(t.size>512e3)return void alert("Fichier trop volumineux ("+(t.size/1024).toFixed(0)+" KB). Maximum: 500 KB");m(t);const a=new FileReader;a.onloadend=()=>{u(a.result)},a.readAsDataURL(t)},disabled:p,className:"hidden"})),React.createElement("span",{className:"text-sm text-gray-600"},o?o.name:"Aucun fichier sélectionné")),d&&React.createElement("div",{className:"mt-3 bg-white border-2 border-purple-300 rounded-lg p-3 sm:p-4"},React.createElement("p",{className:"text-sm font-semibold text-gray-700 mb-2"},"Aperçu:"),React.createElement("div",{className:"flex items-center justify-center"},React.createElement("img",{src:d,alt:"Aperçu",className:"max-h-20 max-w-full object-contain"})))),React.createElement("div",{className:"flex flex-col sm:flex-row gap-3"},React.createElement("button",{onClick:async()=>{if(o){g(!0);try{const e=new FormData;e.append("logo",o),await axios.post(API_URL+"/settings/upload-logo",e,{headers:{"Content-Type":"multipart/form-data"}}),R(Date.now()),m(null),u(null),alert("Logo uploadé avec succès! La page va se recharger pour afficher le nouveau logo..."),setTimeout(()=>{window.location.reload()},1500)}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur")),g(!1)}}else alert("Veuillez sélectionner un fichier")},disabled:!o||p,className:"flex-1 px-4 py-2.5 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-semibold transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",type:"button"},p&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),p?"Upload en cours...":"Uploader le logo"),React.createElement("button",{onClick:async()=>{if(confirm("Voulez-vous vraiment réinitialiser le logo au logo par défaut?")){g(!0);try{await axios.delete(API_URL+"/settings/logo"),R(Date.now()),m(null),u(null),alert("Logo réinitialisé avec succès! La page va se recharger pour afficher le logo par défaut..."),setTimeout(()=>{window.location.reload()},1500)}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur")),g(!1)}}},disabled:p,className:"px-4 py-2.5 bg-red-500 hover:bg-red-600 text-white rounded-lg font-semibold transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",type:"button",title:"Réinitialiser au logo par défaut"},React.createElement("i",{className:"fas fa-undo"}),React.createElement("span",{className:"hidden sm:inline"},"Réinitialiser"),React.createElement("span",{className:"sm:hidden"},"Reset")))),N&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-signature text-amber-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-amber-900 mb-2 flex items-center gap-2"},"Signature Manuscrite",React.createElement("span",{className:"text-xs bg-amber-600 text-white px-2 py-1 rounded"},"ADMIN")),React.createElement("p",{className:"text-sm text-amber-800 mb-2"},"Uploadez votre signature pour les documents officiels générés par le secrétariat IA."),React.createElement("ul",{className:"text-sm text-amber-800 space-y-1 list-disc list-inside"},React.createElement("li",{},"Format: PNG transparent recommandé (GIF, JPG acceptés)"),React.createElement("li",{},"Dimensions: ~300×100 pixels (sera redimensionnée automatiquement)"),React.createElement("li",{},"Taille max: 100 KB"),React.createElement("li",{},'Usage: Demandez "avec ma signature" dans le secrétariat IA'))))),pt&&ot&&React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-check-circle text-green-600 mr-2"}),"Votre signature actuelle"),React.createElement("div",{className:"bg-white border-2 border-green-300 rounded-lg p-4 flex items-center justify-center"},React.createElement("img",{src:ot,alt:"Signature actuelle",className:"max-h-16 max-w-xs object-contain",style:{imageRendering:"auto"}}))),!pt&&React.createElement("div",{className:"mb-4 bg-gray-100 border-2 border-dashed border-gray-300 rounded-lg p-4 text-center text-gray-500"},React.createElement("i",{className:"fas fa-signature text-4xl mb-2 text-gray-400"}),React.createElement("p",{},"Aucune signature enregistrée")),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-upload mr-2"}),pt?"Remplacer la signature":"Uploader votre signature"),React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("label",{className:"cursor-pointer px-4 py-2 bg-amber-100 hover:bg-amber-200 text-amber-700 font-semibold rounded-lg border-2 border-amber-300 transition-all flex items-center gap-2 "+(ct?"opacity-50 cursor-not-allowed":""),style:{pointerEvents:ct?"none":"auto"}},React.createElement("i",{className:"fas fa-folder-open"}),React.createElement("span",{},"Choisir un fichier"),React.createElement("input",{type:"file",accept:"image/png,image/gif,image/jpeg,image/jpg",onChange:e=>{const t=e.target.files[0];if(!t)return;if(!["image/png","image/gif","image/jpeg","image/jpg"].includes(t.type))return void alert("Format non supporté. Utilisez PNG, GIF ou JPG.");if(t.size>102400)return void alert("Fichier trop volumineux. Maximum 100 KB pour une signature.");st(t);const a=new FileReader;a.onloadend=()=>{nt(a.result)},a.readAsDataURL(t)},disabled:ct,className:"hidden"})),React.createElement("span",{className:"text-sm text-gray-600"},rt?rt.name:"Aucun fichier sélectionné")),lt&&React.createElement("div",{className:"mt-3 bg-white border-2 border-amber-300 rounded-lg p-3 sm:p-4"},React.createElement("p",{className:"text-sm font-semibold text-gray-700 mb-2"},"Aperçu:"),React.createElement("div",{className:"flex items-center justify-center"},React.createElement("img",{src:lt,alt:"Aperçu signature",className:"max-h-16 max-w-xs object-contain"})))),React.createElement("div",{className:"flex flex-col sm:flex-row gap-3"},React.createElement("button",{onClick:async()=>{if(rt){it(!0);try{const e=new FormData;e.append("signature",rt),e.append("userId",a.id),e.append("userName",a.fullName||a.email),await axios.post(API_URL+"/settings/signature",e,{headers:{"Content-Type":"multipart/form-data"}}),ut(Date.now()),st(null),nt(null),await Nt(),alert('Signature enregistrée avec succès! Vous pouvez maintenant demander "avec ma signature" dans le secrétariat IA.')}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{it(!1)}}else alert("Veuillez sélectionner un fichier")},disabled:!rt||ct,className:"flex-1 px-4 py-2.5 bg-amber-600 hover:bg-amber-700 text-white rounded-lg font-semibold transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",type:"button"},ct&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),ct?"Upload en cours...":pt?"Remplacer la signature":"Enregistrer la signature"),pt&&React.createElement("button",{onClick:async()=>{if(confirm("Voulez-vous vraiment supprimer votre signature manuscrite?")){it(!0);try{await axios.delete(API_URL+"/settings/signature/"+a.id),st(null),nt(null),mt(null),gt(!1),alert("Signature supprimée.")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{it(!1)}}},disabled:ct,className:"px-4 py-2.5 bg-red-500 hover:bg-red-600 text-white rounded-lg font-semibold transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",type:"button",title:"Supprimer la signature"},React.createElement("i",{className:"fas fa-trash"}),"Supprimer"))),N&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-desktop text-indigo-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-indigo-900 mb-2 flex items-center gap-2"},"Paramètres de l'Application",React.createElement("span",{className:"text-xs bg-indigo-600 text-white px-2 py-1 rounded"},"ADMIN")),React.createElement("p",{className:"text-sm text-indigo-800"},"Nom et identité de l'application.")))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-heading mr-2"}),"Nom de l'application"),T?React.createElement("div",{className:"space-y-3"},React.createElement("input",{type:"text",value:O,onChange:e=>B(e.target.value),placeholder:"Ex: Système de Gestion Interne",maxLength:100,className:"w-full px-4 py-2.5 border-2 border-blue-300 rounded-lg focus:outline-none focus:border-blue-500",disabled:Y}),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs text-gray-600"},O.length+"/100 caractères"),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{B(""),P(!1)},disabled:Y,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{if(O.trim())if(O.trim().length>100)alert("Le titre ne peut pas dépasser 100 caractères");else{ee(!0);try{await axios.put(API_URL+"/settings/title",{value:O.trim()}),w(O.trim()),P(!1),B(""),alert("Titre mis à jour avec succès! La page va se recharger..."),setTimeout(()=>{window.location.reload()},1500)}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{ee(!1)}}else alert("Le titre ne peut pas être vide")},disabled:!O.trim()||Y,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},Y&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),Y?"Enregistrement...":"Enregistrer")))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800"},h),React.createElement("button",{onClick:()=>{B(h),P(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Modifier")))),N&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-emerald-50 border border-emerald-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-building text-emerald-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-emerald-900 mb-2 flex items-center gap-2"},"Informations de l'Entreprise",React.createElement("span",{className:"text-xs bg-emerald-600 text-white px-2 py-1 rounded"},"ADMIN")),React.createElement("p",{className:"text-sm text-emerald-800"},"Ces informations apparaissent sur les documents imprimés et les correspondances.")))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-building mr-2"}),"Nom officiel de l'entreprise"),j?React.createElement("div",{className:"space-y-3"},React.createElement("input",{type:"text",value:W,onChange:e=>H(e.target.value),placeholder:"Ex: Les Produits Verriers International Inc.",maxLength:150,className:"w-full px-4 py-2.5 border-2 border-blue-300 rounded-lg focus:outline-none focus:border-blue-500",disabled:te}),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs text-gray-600"},W.length+"/150 caractères"),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{H(""),D(!1)},disabled:te,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{if(W.trim())if(W.trim().length>150)alert("Le nom ne peut pas dépasser 150 caractères");else{ae(!0);try{await axios.put(API_URL+"/settings/company_name",{value:W.trim()}),_(W.trim()),D(!1),H(""),alert("Nom de l'entreprise mis à jour avec succès!")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{ae(!1)}}else alert("Le nom de l'entreprise ne peut pas être vide")},disabled:!W.trim()||te,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},te&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),te?"Enregistrement...":"Enregistrer")))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800"},C||React.createElement("span",{className:"text-gray-400 italic"},"Non configuré")),React.createElement("button",{onClick:()=>{H(C),D(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Modifier"))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-map-marker-alt mr-2"}),"Adresse de l'entreprise"),M?React.createElement("div",{className:"space-y-3"},React.createElement("input",{type:"text",value:K,onChange:e=>Q(e.target.value),placeholder:"Ex: 9150 Bd Maurice-Duplessis, Montréal, QC H1E 7C2",maxLength:200,className:"w-full px-4 py-2.5 border-2 border-blue-300 rounded-lg focus:outline-none focus:border-blue-500",disabled:re}),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs text-gray-600"},K.length+"/200 caractères"),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{Q(""),z(!1)},disabled:re,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{if(K.trim().length>200)alert("L'adresse ne peut pas dépasser 200 caractères");else{se(!0);try{await axios.put(API_URL+"/settings/company_address",{value:K.trim()}),A(K.trim()),z(!1),Q(""),alert("Adresse mise à jour avec succès!")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{se(!1)}}},disabled:re,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},re&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),re?"Enregistrement...":"Enregistrer")))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800"},S||React.createElement("span",{className:"text-gray-400 italic"},"Non configurée")),React.createElement("button",{onClick:()=>{Q(S),z(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Modifier"))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-envelope mr-2"}),"Courriel officiel"),V?React.createElement("div",{className:"space-y-3"},React.createElement("input",{type:"email",value:J,onChange:e=>$(e.target.value),placeholder:"Ex: info@entreprise.com",maxLength:100,className:"w-full px-4 py-2.5 border-2 border-blue-300 rounded-lg focus:outline-none focus:border-blue-500",disabled:le}),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs text-gray-600"},J.length+"/100 caractères"),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{$(""),F(!1)},disabled:le,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{const e=J.trim();if(!e||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))if(e.length>100)alert("Le courriel ne peut pas dépasser 100 caractères");else{ne(!0);try{await axios.put(API_URL+"/settings/company_email",{value:e}),L(e),F(!1),$(""),alert("Courriel mis à jour avec succès!")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{ne(!1)}}else alert("Format de courriel invalide")},disabled:le,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},le&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),le?"Enregistrement...":"Enregistrer")))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800"},U||React.createElement("span",{className:"text-gray-400 italic"},"Non configuré")),React.createElement("button",{onClick:()=>{$(U),F(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Modifier"))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-phone mr-2"}),"Téléphone"),q?React.createElement("div",{className:"space-y-3"},React.createElement("input",{type:"tel",value:Z,onChange:e=>X(e.target.value),placeholder:"Ex: 514-494-1940",maxLength:30,className:"w-full px-4 py-2.5 border-2 border-blue-300 rounded-lg focus:outline-none focus:border-blue-500",disabled:ce}),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs text-gray-600"},Z.length+"/30 caractères"),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{X(""),G(!1)},disabled:ce,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{const e=Z.trim();if(e.length>30)alert("Le téléphone ne peut pas dépasser 30 caractères");else{ie(!0);try{await axios.put(API_URL+"/settings/company_phone",{value:e}),I(e),G(!1),X(""),alert("Téléphone mis à jour avec succès!")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{ie(!1)}}},disabled:ce,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},ce&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),ce?"Enregistrement...":"Enregistrer")))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800"},k||React.createElement("span",{className:"text-gray-400 italic"},"Non configuré")),React.createElement("button",{onClick:()=>{X(k),G(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Modifier")))),N&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-comments text-blue-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-blue-900 mb-2 flex items-center gap-2"},"Paramètres de Messagerie",React.createElement("span",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded"},"ADMIN")),React.createElement("p",{className:"text-sm text-blue-800"},"Configuration du module de messagerie.")))),React.createElement("div",{className:"mb-0"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-comments mr-2"}),'Nom du bouton "Connect" (Messagerie externe)'),Ee?React.createElement("div",{className:"space-y-3"},React.createElement("input",{type:"text",value:Ne,onChange:e=>ve(e.target.value),placeholder:"Ex: Connect, Ma Messagerie...",maxLength:50,className:"w-full px-4 py-2.5 border-2 border-blue-300 rounded-lg focus:outline-none focus:border-blue-500",disabled:he}),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs text-gray-600"},Ne.length+"/50 caractères"),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{ve(""),ye(!1)},disabled:he,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{if(Ne.trim())if(Ne.length>50)alert("Le nom ne peut pas dépasser 50 caractères");else{we(!0);try{await axios.put(API_URL+"/settings/messenger_app_name",{value:Ne.trim()}),Re(Ne.trim()),ye(!1),ve(""),alert("Nom de l'application messagerie mis à jour ! La page va se recharger..."),setTimeout(()=>{window.location.reload()},1500)}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{we(!1)}}else alert("Le nom ne peut pas être vide")},disabled:!Ne.trim()||he,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},he&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),he?"Enregistrement...":"Enregistrer")))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800"},fe),React.createElement("button",{onClick:()=>{ve(fe),ye(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Modifier")))),N&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-user-tie text-green-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-green-900 mb-2 flex items-center gap-2"},"Configuration de l'Expert",React.createElement("span",{className:"text-xs bg-purple-600 text-white px-2 py-1 rounded"},"NOUVEAU")),React.createElement("p",{className:"text-sm text-green-800 mb-2"},"Configurez l'identité, le caractère et les connaissances techniques de votre Expert."),React.createElement("div",{className:"mt-3"},React.createElement("a",{href:"/admin/ai-settings",className:"inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-bold text-sm transition shadow-sm gap-2",target:"_self"},React.createElement("i",{className:"fas fa-sliders-h"}),"Ouvrir le Configurateur Avancé"))))),React.createElement("details",{className:"mb-0 group"},React.createElement("summary",{className:"cursor-pointer text-sm font-semibold text-gray-500 hover:text-gray-700 mb-2 flex items-center select-none"},React.createElement("i",{className:"fas fa-chevron-right mr-2 transition-transform group-open:rotate-90"}),"Voir l'ancien éditeur de contexte (Legacy)"),React.createElement("div",{className:"pl-4 border-l-2 border-gray-200 mt-2"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-file-alt mr-2"}),"Prompt Principal & Contexte"),de?React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex justify-end"},React.createElement("button",{onClick:()=>ge("RÔLE : Expert Industriel Senior\n\nMISSION :\nAssister les techniciens et administrateurs dans la maintenance, le diagnostic de pannes et l'optimisation de la production.\n\nRÈGLES D'OR :\n1. SÉCURITÉ AVANT TOUT : Rappeler systématiquement les procédures de sécurité avant toute intervention.\n2. CONTEXTE INDUSTRIEL : Se concentrer uniquement sur les machines, la maintenance, la production et la sécurité.\n3. TON PROFESSIONNEL : Être direct, précis et factuel.\n\nCONTEXTE :\n- Nous sommes une entreprise de production industrielle.\n- Les équipements critiques doivent être maintenus en priorité.\n- La production fonctionne en continu."),className:"text-xs text-blue-600 hover:text-blue-800 underline",type:"button"},"Charger le modèle par défaut")),React.createElement("textarea",{value:pe,onChange:e=>ge(e.target.value),placeholder:"Ex: Nous sommes une usine de fabrication de verre. Les machines critiques sont les Fours et les CNC. La sécurité est la priorité absolue.",maxLength:3e4,rows:6,className:"w-full px-4 py-2.5 border-2 border-blue-300 rounded-lg focus:outline-none focus:border-blue-500",disabled:be}),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs text-gray-600"},pe.length+"/30000 caractères"),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{ge(""),ue(!1)},disabled:be,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{if(pe.length>3e4)alert("Le contexte AI ne peut pas dépasser 30000 caractères");else{xe(!0);try{await axios.put(API_URL+"/settings/ai_custom_context",{value:pe.trim()}),me(pe.trim()),ue(!1),ge(""),alert("Contexte AI mis à jour avec succès!")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{xe(!1)}}},disabled:be,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},be&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),be?"Enregistrement...":"Enregistrer")))):React.createElement("div",{className:"flex flex-col gap-3"},React.createElement("div",{className:"bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800 whitespace-pre-wrap min-h-[60px] text-sm font-mono"},oe||React.createElement("div",{className:"text-gray-500 italic"},React.createElement("p",{className:"font-bold mb-1"},"Prompt par défaut actif :"),"RÔLE : Expert Industriel Senior...",React.createElement("br"),"(Cliquez sur Modifier pour voir ou personnaliser le prompt complet)")),React.createElement("button",{onClick:()=>{ge(oe),ue(!0)},className:"self-start px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Modifier (Legacy)")))))),React.createElement("div",{className:"p-6 border-t border-gray-200 bg-gray-50 flex justify-end gap-3"},React.createElement("button",{onClick:t,disabled:c,className:"px-6 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{i(!0);try{await axios.put(API_URL+"/settings/timezone_offset_hours",{value:r}),localStorage.setItem("timezone_offset_hours",r),alert("Paramètres mis à jour avec succès!"),t()}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{i(!1)}},disabled:c,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2",type:"button"},c&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),c?"Enregistrement...":"Enregistrer"))))):null};