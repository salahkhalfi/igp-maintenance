const SystemSettingsModal=({show:e,onClose:t,currentUser:a})=>{const[r,l]=React.useState("-5"),[s,n]=React.useState(!0),[c,o]=React.useState(!1),[i,m]=React.useState(null),[d,u]=React.useState(null),[p,g]=React.useState(!1),[b,x]=React.useState("/api/settings/logo"),[f,R]=React.useState(Date.now()),[E,y]=React.useState(!1),[v,N]=React.useState("Gestion de la maintenance et des réparations"),[h,w]=React.useState("Système de Maintenance Universel"),[C,_]=React.useState(!1),[L,S]=React.useState(!1),[U,T]=React.useState(""),[A,k]=React.useState(""),[I,P]=React.useState(!1),[j,D]=React.useState(!1),[M,z]=React.useState(""),[q,O]=React.useState(!1),[F,V]=React.useState(""),[W,B]=React.useState(!1),[G,H]=React.useState("Connect"),[Q,K]=React.useState(!1),[J,X]=React.useState(""),[Z,Y]=React.useState(!1),[$,ee]=React.useState(""),[te,ae]=React.useState(!1),[re,le]=React.useState(""),[se,ne]=React.useState(!1),[ce,oe]=React.useState(""),[ie,me]=React.useState(!1),[de,ue]=React.useState(""),[pe,ge]=React.useState(!1),[be,xe]=React.useState(!1),[fe,Re]=React.useState(!1),[Ee,ye]=React.useState({placeholder_machine_type:"Ex: Équipement, Machine...",placeholder_location:"Ex: Zone A, Atelier...",placeholder_manufacturer:"Ex: Marque, Fabricant..."}),[ve,Ne]=React.useState(!1),[he,we]=React.useState({}),[Ce,_e]=React.useState(!1),[Le,Se]=React.useState({planning:!0,statistics:!0,notifications:!0,messaging:!0,machines:!0}),[Ue,Te]=React.useState({planning:!0,statistics:!0,notifications:!0,messaging:!0,machines:!0});React.useEffect(()=>{e&&(async()=>{let e=!1;a&&"admin"===a.role&&(e=!0,y(!0)),await ke(e),Ae()})()},[e,a]);const Ae=async()=>{try{const e=await axios.get(API_URL+"/settings/modules/status");Se(e.data);const t=await axios.get(API_URL+"/settings/modules/preferences");Te(t.data)}catch(e){console.error(e)}},ke=async e=>{n(!0);try{const t=await axios.get(API_URL+"/settings/timezone_offset_hours");if(l(t.data.setting_value),e){try{const e=await axios.get(API_URL+"/settings/company_title");e.data.setting_value&&N(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/company_subtitle");e.data.setting_value&&w(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/ai_custom_context");e.data.setting_value&&z(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/messenger_app_name");e.data.setting_value&&H(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/app_base_url");e.data.value?ee(e.data.value):ee(window.location.origin)}catch(e){ee(window.location.origin)}try{const e=await axios.get(API_URL+"/settings/webhook_url");e.data.setting_value&&oe(e.data.setting_value)}catch(e){}try{const e=await axios.get(API_URL+"/settings/rate_limit_enabled");xe("true"===e.data.setting_value)}catch(e){xe(!1)}try{const e=await axios.get(API_URL+"/settings/placeholders");e.data&&ye(e.data)}catch(e){}}}catch(e){}finally{n(!1)}},[Ie,Pe]=React.useState(!1);return e?React.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[10000] p-4 backdrop-blur-sm",onClick:t},React.createElement("div",{className:"bg-white rounded-lg border border-gray-300 max-w-2xl w-full max-h-[85vh] sm:max-h-[90vh] overflow-hidden",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-purple-50"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2"},React.createElement("i",{className:"fas fa-cog"}),"Paramètres Système"),React.createElement("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 text-2xl",type:"button"},"×"))),React.createElement("div",{className:"p-6 overflow-y-auto",style:{maxHeight:"calc(90vh - 180px)"}},s?React.createElement("div",{className:"text-center py-8"},React.createElement("i",{className:"fas fa-spinner fa-spin text-3xl text-blue-600"})):React.createElement("div",{className:"space-y-6"},React.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-info-circle text-blue-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-blue-900 mb-2"},"À propos du décalage horaire"),React.createElement("p",{className:"text-sm text-blue-800 mb-2"},"Le décalage horaire permet d'ajuster l'heure du serveur pour correspondre à votre fuseau horaire local."),React.createElement("ul",{className:"text-sm text-blue-800 space-y-1 list-disc list-inside"},React.createElement("li",{},"Hiver (EST): -5 heures"),React.createElement("li",{},"Ete (EDT): -4 heures"),React.createElement("li",{},"Impacte: alertes retard, countdowns"))))),React.createElement("div",{},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-clock mr-2"}),"Decalage horaire (heures par rapport a UTC)"),React.createElement("select",{value:r,onChange:e=>l(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg font-semibold"},React.createElement("option",{value:"-12"},"UTC-12"),React.createElement("option",{value:"-11"},"UTC-11"),React.createElement("option",{value:"-10"},"UTC-10 (Hawaii)"),React.createElement("option",{value:"-9"},"UTC-9 (Alaska)"),React.createElement("option",{value:"-8"},"UTC-8 (PST)"),React.createElement("option",{value:"-7"},"UTC-7 (MST)"),React.createElement("option",{value:"-6"},"UTC-6 (CST)"),React.createElement("option",{value:"-5"},"UTC-5 (EST - Hiver Quebec)"),React.createElement("option",{value:"-4"},"UTC-4 (EDT - Ete Quebec)"),React.createElement("option",{value:"-3"},"UTC-3"),React.createElement("option",{value:"-2"},"UTC-2"),React.createElement("option",{value:"-1"},"UTC-1"),React.createElement("option",{value:"0"},"UTC+0 (Londres)"),React.createElement("option",{value:"1"},"UTC+1 (Paris)"),React.createElement("option",{value:"2"},"UTC+2"),React.createElement("option",{value:"3"},"UTC+3"),React.createElement("option",{value:"4"},"UTC+4"),React.createElement("option",{value:"5"},"UTC+5"),React.createElement("option",{value:"6"},"UTC+6"),React.createElement("option",{value:"7"},"UTC+7"),React.createElement("option",{value:"8"},"UTC+8 (Hong Kong)"),React.createElement("option",{value:"9"},"UTC+9 (Tokyo)"),React.createElement("option",{value:"10"},"UTC+10 (Sydney)"),React.createElement("option",{value:"11"},"UTC+11"),React.createElement("option",{value:"12"},"UTC+12"),React.createElement("option",{value:"13"},"UTC+13"),React.createElement("option",{value:"14"},"UTC+14")),React.createElement("p",{className:"mt-2 text-sm text-gray-600"},"Actuellement selectionne: UTC",r," (",-5===parseInt(r)?"EST - Hiver Quebec":-4===parseInt(r)?"EDT - Ete Quebec":"Personnalise",")")),React.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-exclamation-triangle text-yellow-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-yellow-900 mb-1"},"Attention"),React.createElement("p",{className:"text-sm text-yellow-800"},"Changez ce paramètre uniquement lors du changement d'heure (mars et novembre).")))),E&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-shield-alt text-red-600 text-xl mt-1"}),React.createElement("div",{className:"flex-1"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("div",{},React.createElement("h3",{className:"font-bold text-red-900 mb-1 flex items-center gap-2"},"Protection Anti-Abus",React.createElement("span",{className:"text-xs px-2 py-0.5 rounded "+(be?"bg-green-600 text-white":"bg-gray-400 text-white")},be?"ACTIVÉ":"DÉSACTIVÉ")),React.createElement("p",{className:"text-sm text-red-800"},be?"Limite les tentatives de connexion et les appels API pour protéger contre les attaques.":"Désactivé pour le développement. Activer pour la production.")),React.createElement("button",{onClick:async()=>{const e=!be;Re(!0);try{await axios.put(API_URL+"/settings/rate_limit_enabled",{value:e?"true":"false"}),xe(e),alert(e?"Protection anti-abus ACTIVÉE":"Protection anti-abus DÉSACTIVÉE")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{Re(!1)}},disabled:fe,className:"ml-4 px-4 py-2 rounded-lg font-bold text-sm transition shadow-sm flex items-center gap-2 "+(be?"bg-gray-500 hover:bg-gray-600 text-white":"bg-green-600 hover:bg-green-700 text-white")},fe&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),be?"Désactiver":"Activer")))))),E&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-teal-50 border border-teal-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-industry text-teal-600 text-xl mt-1"}),React.createElement("div",{className:"flex-1"},React.createElement("h3",{className:"font-bold text-teal-900 mb-2 flex items-center gap-2"},"Personnalisation Industrie",React.createElement("span",{className:"text-xs bg-teal-600 text-white px-2 py-1 rounded"},"SaaS")),React.createElement("p",{className:"text-sm text-teal-800 mb-3"},"Personnalisez les exemples affichés dans les formulaires selon votre secteur d'activité (boulangerie, garage, hôtel...)."),ve?React.createElement("div",{className:"space-y-3 bg-white rounded-lg p-4 border border-teal-200"},React.createElement("div",{},React.createElement("label",{className:"block text-xs font-semibold text-gray-600 mb-1"},"Type d'équipement"),React.createElement("input",{type:"text",value:he.placeholder_machine_type||"",onChange:e=>we({...he,placeholder_machine_type:e.target.value}),placeholder:"Ex: Four, Pétrin, Véhicule...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-teal-500 text-sm",disabled:Ce})),React.createElement("div",{},React.createElement("label",{className:"block text-xs font-semibold text-gray-600 mb-1"},"Emplacement"),React.createElement("input",{type:"text",value:he.placeholder_location||"",onChange:e=>we({...he,placeholder_location:e.target.value}),placeholder:"Ex: Cuisine, Garage, Chambre 101...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-teal-500 text-sm",disabled:Ce})),React.createElement("div",{},React.createElement("label",{className:"block text-xs font-semibold text-gray-600 mb-1"},"Fabricant / Marque"),React.createElement("input",{type:"text",value:he.placeholder_manufacturer||"",onChange:e=>we({...he,placeholder_manufacturer:e.target.value}),placeholder:"Ex: Bosch, Caterpillar, Samsung...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-teal-500 text-sm",disabled:Ce})),React.createElement("div",{className:"flex justify-end gap-2 pt-2"},React.createElement("button",{onClick:()=>{Ne(!1),we({})},disabled:Ce,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{_e(!0);try{await axios.put(API_URL+"/settings/placeholders",he,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),ye(he),Ne(!1),alert("Exemples mis à jour avec succès !")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{_e(!1)}},disabled:Ce,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50",type:"button"},Ce&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),Ce?"Enregistrement...":"Enregistrer"))):React.createElement("div",{className:"space-y-2"},React.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm"},React.createElement("div",{className:"bg-white rounded p-2 border border-teal-100"},React.createElement("span",{className:"text-gray-500"},"Type: "),React.createElement("span",{className:"font-medium"},Ee.placeholder_machine_type||"Non défini")),React.createElement("div",{className:"bg-white rounded p-2 border border-teal-100"},React.createElement("span",{className:"text-gray-500"},"Lieu: "),React.createElement("span",{className:"font-medium"},Ee.placeholder_location||"Non défini")),React.createElement("div",{className:"bg-white rounded p-2 border border-teal-100"},React.createElement("span",{className:"text-gray-500"},"Fabricant: "),React.createElement("span",{className:"font-medium"},Ee.placeholder_manufacturer||"Non défini"))),React.createElement("button",{onClick:()=>{we({...Ee}),Ne(!0)},className:"mt-3 px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Personnaliser les exemples")))))),React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-broom text-orange-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-orange-900 mb-2"},"Maintenance Base de Données"),React.createElement("p",{className:"text-sm text-orange-800 mb-2"},"Nettoyage manuel des données obsolètes (Le Concierge)."),React.createElement("button",{onClick:async()=>{if(confirm("Lancer le nettoyage manuel ?\n\nCela supprimera :\n- Événements > 3 mois\n- Notes terminées > 30 jours\n- Et optimisera la base de données.")){Pe(!0);try{const e=await axios.post(API_URL+"/settings/trigger-cleanup");alert("Nettoyage terminé avec succès !\n\n"+JSON.stringify(e.data.deleted,null,2))}catch(e){alert("Erreur ou fonction non disponible: "+(e.response?.data?.error||e.message))}finally{Pe(!1)}}},disabled:Ie,className:"mt-2 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-bold text-sm transition shadow-sm flex items-center gap-2 disabled:opacity-50"},Ie&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),Ie?"Nettoyage...":"Lancer le nettoyage maintenant"))))),E&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-globe text-indigo-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-indigo-900 mb-2 flex items-center gap-2"},"Domaine & URL Système",React.createElement("span",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded"},"CRITIQUE")),React.createElement("p",{className:"text-sm text-indigo-800 mb-2"},"Définit l'URL de base utilisée par l'IA et les notifications pour générer des liens.")))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-link mr-2"}),"URL de base (Base URL)"),te?React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex gap-2"},React.createElement("input",{type:"text",value:re,onChange:e=>le(e.target.value),placeholder:"https://votre-domaine.com",className:"flex-1 px-4 py-2.5 border-2 border-indigo-300 rounded-lg focus:outline-none focus:border-indigo-500 font-mono text-sm",disabled:se}),React.createElement("button",{onClick:()=>{le(window.location.origin)},className:"px-3 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-semibold text-sm whitespace-nowrap",title:"Auto-détecter l'URL actuelle",type:"button"},React.createElement("i",{className:"fas fa-magic"})," Auto")),React.createElement("div",{className:"flex items-center justify-end gap-2"},React.createElement("button",{onClick:()=>{le(""),ae(!1)},disabled:se,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{let e=re.trim();if(e){e.endsWith("/")&&(e=e.slice(0,-1)),e.startsWith("http://")||e.startsWith("https://")||(e="https://"+e),ne(!0);try{await axios.put(API_URL+"/settings/app_base_url",{value:e}),ee(e),ae(!1),le(""),alert("Domaine mis à jour avec succès !")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{ne(!1)}}else alert("L'URL ne peut pas être vide")},disabled:!re.trim()||se,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},se&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),se?"Enregistrement...":"Enregistrer"))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800 font-mono text-sm"},$||("undefined"!=typeof window?window.location.origin:"")),React.createElement("button",{onClick:()=>{le($),ae(!0)},className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Configurer")))),E&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-teal-50 border border-teal-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-plug text-teal-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-teal-900 mb-2 flex items-center gap-2"},"Intégrations & Webhooks",React.createElement("span",{className:"text-xs bg-teal-600 text-white px-2 py-1 rounded"},"OPTIONNEL")),React.createElement("p",{className:"text-sm text-teal-800 mb-2"},"Connectez votre application à des services externes (Pabbly, Make, Zapier, n8n...)."),React.createElement("p",{className:"text-xs text-teal-700"},"Les événements (ticket créé, en retard, etc.) seront envoyés à cette URL.")))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-link mr-2"}),"URL du Webhook (laisser vide pour désactiver)"),ie?React.createElement("div",{className:"space-y-3"},React.createElement("input",{type:"text",value:de,onChange:e=>ue(e.target.value),placeholder:"https://connect.pabbly.com/workflow/... ou https://hook.make.com/...",className:"w-full px-4 py-2.5 border-2 border-teal-300 rounded-lg focus:outline-none focus:border-teal-500 font-mono text-sm",disabled:pe}),React.createElement("div",{className:"flex items-center justify-end gap-2"},React.createElement("button",{onClick:()=>{ue(""),me(!1)},disabled:pe,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{let e=de.trim();!e||e.startsWith("http://")||e.startsWith("https://")||(e="https://"+e),ge(!0);try{await axios.put(API_URL+"/settings/webhook_url",{value:e}),oe(e),me(!1),ue(""),alert(e?"Webhook configuré avec succès !":"Webhook désactivé.")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{ge(!1)}},disabled:pe,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50",type:"button"},pe&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),pe?"Enregistrement...":"Enregistrer"))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800 font-mono text-sm truncate"},ce||React.createElement("span",{className:"text-gray-500 italic"},"Non configuré (notifications désactivées)")),React.createElement("button",{onClick:()=>{ue(ce),me(!0)},className:"px-4 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Configurer")))),E&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-image text-purple-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-purple-900 mb-2 flex items-center gap-2"},"Logo de l'entreprise",React.createElement("span",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded"},"ADMIN")),React.createElement("p",{className:"text-sm text-purple-800 mb-2"},"Personnalisez le logo affiché dans l'application."),React.createElement("ul",{className:"text-sm text-purple-800 space-y-1 list-disc list-inside"},React.createElement("li",{},"Format: PNG transparent recommandé"),React.createElement("li",{},"Dimensions: 200×80 pixels (ratio 2.5:1)"),React.createElement("li",{},"Taille max: 500 KB"))))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-eye mr-2"}),"Logo actuel"),React.createElement("div",{className:"bg-gray-100 border-2 border-gray-300 rounded-lg p-4 flex items-center justify-center"},React.createElement("img",{src:b+"?t="+f,alt:"Logo actuel",className:"max-h-20 max-w-full object-contain",onError:e=>{e.target.src="/logo.png"}}))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-upload mr-2"}),"Uploader un nouveau logo"),React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("label",{className:"cursor-pointer px-4 py-2 bg-purple-100 hover:bg-purple-200 text-purple-700 font-semibold rounded-lg border-2 border-purple-300 transition-all flex items-center gap-2 "+(p?"opacity-50 cursor-not-allowed":""),style:{pointerEvents:p?"none":"auto"}},React.createElement("i",{className:"fas fa-folder-open"}),React.createElement("span",{},"Choisir un fichier"),React.createElement("input",{type:"file",accept:"image/png,image/jpeg,image/jpg,image/webp",onChange:e=>{const t=e.target.files?.[0];if(!t)return;if(!["image/png","image/jpeg","image/jpg","image/webp"].includes(t.type))return void alert("Type de fichier non autorisé. Utilisez PNG, JPEG ou WEBP.");if(t.size>512e3)return void alert("Fichier trop volumineux ("+(t.size/1024).toFixed(0)+" KB). Maximum: 500 KB");m(t);const a=new FileReader;a.onloadend=()=>{u(a.result)},a.readAsDataURL(t)},disabled:p,className:"hidden"})),React.createElement("span",{className:"text-sm text-gray-600"},i?i.name:"Aucun fichier sélectionné")),d&&React.createElement("div",{className:"mt-3 bg-white border-2 border-purple-300 rounded-lg p-3 sm:p-4"},React.createElement("p",{className:"text-sm font-semibold text-gray-700 mb-2"},"Aperçu:"),React.createElement("div",{className:"flex items-center justify-center"},React.createElement("img",{src:d,alt:"Aperçu",className:"max-h-20 max-w-full object-contain"})))),React.createElement("div",{className:"flex flex-col sm:flex-row gap-3"},React.createElement("button",{onClick:async()=>{if(i){g(!0);try{const e=new FormData;e.append("logo",i),await axios.post(API_URL+"/settings/upload-logo",e,{headers:{"Content-Type":"multipart/form-data"}}),R(Date.now()),m(null),u(null),alert("Logo uploadé avec succès! La page va se recharger pour afficher le nouveau logo..."),setTimeout(()=>{window.location.reload()},1500)}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur")),g(!1)}}else alert("Veuillez sélectionner un fichier")},disabled:!i||p,className:"flex-1 px-4 py-2.5 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-semibold transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",type:"button"},p&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),p?"Upload en cours...":"Uploader le logo"),React.createElement("button",{onClick:async()=>{if(confirm("Voulez-vous vraiment réinitialiser le logo au logo par défaut?")){g(!0);try{await axios.delete(API_URL+"/settings/logo"),R(Date.now()),m(null),u(null),alert("Logo réinitialisé avec succès! La page va se recharger pour afficher le logo par défaut..."),setTimeout(()=>{window.location.reload()},1500)}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur")),g(!1)}}},disabled:p,className:"px-4 py-2.5 bg-red-500 hover:bg-red-600 text-white rounded-lg font-semibold transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",type:"button",title:"Réinitialiser au logo par défaut"},React.createElement("i",{className:"fas fa-undo"}),React.createElement("span",{className:"hidden sm:inline"},"Réinitialiser"),React.createElement("span",{className:"sm:hidden"},"Reset")))),E&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-heading text-blue-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-blue-900 mb-2 flex items-center gap-2"},"Personnalisation de l'Interface",React.createElement("span",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded"},"ADMIN")),React.createElement("p",{className:"text-sm text-blue-800 mb-2"},"Personnalisez les titres et noms affichés dans l'application.")))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-heading mr-2"}),"Titre principal"),C?React.createElement("div",{className:"space-y-3"},React.createElement("input",{type:"text",value:U,onChange:e=>T(e.target.value),placeholder:"Entrez le nouveau titre",maxLength:100,className:"w-full px-4 py-2.5 border-2 border-blue-300 rounded-lg focus:outline-none focus:border-blue-500",disabled:I}),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs text-gray-600"},U.length+"/100 caractères"),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{T(""),_(!1)},disabled:I,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{if(U.trim())if(U.trim().length>100)alert("Le titre ne peut pas dépasser 100 caractères");else{P(!0);try{await axios.put(API_URL+"/settings/title",{value:U.trim()}),N(U.trim()),_(!1),T(""),alert("Titre mis à jour avec succès! La page va se recharger..."),setTimeout(()=>{window.location.reload()},1500)}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{P(!1)}}else alert("Le titre ne peut pas être vide")},disabled:!U.trim()||I,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},I&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),I?"Enregistrement...":"Enregistrer")))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800"},v),React.createElement("button",{onClick:()=>{T(v),_(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Modifier"))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-align-left mr-2"}),"Sous-titre"),L?React.createElement("div",{className:"space-y-3"},React.createElement("input",{type:"text",value:A,onChange:e=>k(e.target.value),placeholder:"Entrez le nouveau sous-titre",maxLength:150,className:"w-full px-4 py-2.5 border-2 border-blue-300 rounded-lg focus:outline-none focus:border-blue-500",disabled:j}),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs text-gray-600"},A.length+"/150 caractères"),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{k(""),S(!1)},disabled:j,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{if(A.trim())if(A.trim().length>150)alert("Le sous-titre ne peut pas dépasser 150 caractères");else{D(!0);try{await axios.put(API_URL+"/settings/subtitle",{value:A.trim()}),w(A.trim()),S(!1),k(""),alert("Sous-titre mis à jour avec succès! La page va se recharger..."),setTimeout(()=>{window.location.reload()},1500)}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{D(!1)}}else alert("Le sous-titre ne peut pas être vide")},disabled:!A.trim()||j,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},j&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),j?"Enregistrement...":"Enregistrer")))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800"},h),React.createElement("button",{onClick:()=>{k(h),S(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Modifier"))),React.createElement("div",{className:"mb-0"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-comments mr-2"}),'Nom du bouton "Connect" (Messagerie externe)'),Q?React.createElement("div",{className:"space-y-3"},React.createElement("input",{type:"text",value:J,onChange:e=>X(e.target.value),placeholder:"Ex: Connect, Ma Messagerie...",maxLength:50,className:"w-full px-4 py-2.5 border-2 border-blue-300 rounded-lg focus:outline-none focus:border-blue-500",disabled:Z}),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs text-gray-600"},J.length+"/50 caractères"),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{X(""),K(!1)},disabled:Z,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{if(J.trim())if(J.length>50)alert("Le nom ne peut pas dépasser 50 caractères");else{Y(!0);try{await axios.put(API_URL+"/settings/messenger_app_name",{value:J.trim()}),H(J.trim()),K(!1),X(""),alert("Nom de l'application messagerie mis à jour ! La page va se recharger..."),setTimeout(()=>{window.location.reload()},1500)}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{Y(!1)}}else alert("Le nom ne peut pas être vide")},disabled:!J.trim()||Z,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},Z&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),Z?"Enregistrement...":"Enregistrer")))):React.createElement("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center"},React.createElement("div",{className:"flex-1 bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800"},G),React.createElement("button",{onClick:()=>{X(G),K(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Modifier")))),E&&React.createElement("div",{className:"border-t border-gray-300 pt-6 mt-6"},React.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4"},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("i",{className:"fas fa-brain text-green-600 text-xl mt-1"}),React.createElement("div",{},React.createElement("h3",{className:"font-bold text-green-900 mb-2 flex items-center gap-2"},"Cerveau de l'IA & Connaissances",React.createElement("span",{className:"text-xs bg-purple-600 text-white px-2 py-1 rounded"},"NOUVEAU")),React.createElement("p",{className:"text-sm text-green-800 mb-2"},"Configurez l'identité, le caractère et les connaissances techniques de l'IA."),React.createElement("div",{className:"mt-3"},React.createElement("a",{href:"/admin/ai-settings",className:"inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-bold text-sm transition shadow-sm gap-2",target:"_self"},React.createElement("i",{className:"fas fa-sliders-h"}),"Ouvrir le Configurateur Avancé"))))),React.createElement("details",{className:"mb-0 group"},React.createElement("summary",{className:"cursor-pointer text-sm font-semibold text-gray-500 hover:text-gray-700 mb-2 flex items-center select-none"},React.createElement("i",{className:"fas fa-chevron-right mr-2 transition-transform group-open:rotate-90"}),"Voir l'ancien éditeur de contexte (Legacy)"),React.createElement("div",{className:"pl-4 border-l-2 border-gray-200 mt-2"},React.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},React.createElement("i",{className:"fas fa-file-alt mr-2"}),"Prompt Principal & Contexte"),q?React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex justify-end"},React.createElement("button",{onClick:()=>V("RÔLE : Expert Industriel Senior\n\nMISSION :\nAssister les techniciens et administrateurs dans la maintenance, le diagnostic de pannes et l'optimisation de la production.\n\nRÈGLES D'OR :\n1. SÉCURITÉ AVANT TOUT : Rappeler systématiquement les procédures de sécurité avant toute intervention.\n2. CONTEXTE INDUSTRIEL : Se concentrer uniquement sur les machines, la maintenance, la production et la sécurité.\n3. TON PROFESSIONNEL : Être direct, précis et factuel.\n\nCONTEXTE :\n- Nous sommes une entreprise de production industrielle.\n- Les équipements critiques doivent être maintenus en priorité.\n- La production fonctionne en continu."),className:"text-xs text-blue-600 hover:text-blue-800 underline",type:"button"},"Charger le modèle par défaut")),React.createElement("textarea",{value:F,onChange:e=>V(e.target.value),placeholder:"Ex: Nous sommes une usine de fabrication de verre. Les machines critiques sont les Fours et les CNC. La sécurité est la priorité absolue.",maxLength:3e4,rows:6,className:"w-full px-4 py-2.5 border-2 border-blue-300 rounded-lg focus:outline-none focus:border-blue-500",disabled:W}),React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-xs text-gray-600"},F.length+"/30000 caractères"),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>{V(""),O(!1)},disabled:W,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all text-sm disabled:opacity-50",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{if(F.length>3e4)alert("Le contexte AI ne peut pas dépasser 30000 caractères");else{B(!0);try{await axios.put(API_URL+"/settings/ai_custom_context",{value:F.trim()}),z(F.trim()),O(!1),V(""),alert("Contexte AI mis à jour avec succès!")}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{B(!1)}}},disabled:W,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed",type:"button"},W&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),W?"Enregistrement...":"Enregistrer")))):React.createElement("div",{className:"flex flex-col gap-3"},React.createElement("div",{className:"bg-gray-100 border-2 border-gray-300 rounded-lg p-3 text-gray-800 whitespace-pre-wrap min-h-[60px] text-sm font-mono"},M||React.createElement("div",{className:"text-gray-500 italic"},React.createElement("p",{className:"font-bold mb-1"},"Prompt par défaut actif :"),"RÔLE : Expert Industriel Senior...",React.createElement("br"),"(Cliquez sur Modifier pour voir ou personnaliser le prompt complet)")),React.createElement("button",{onClick:()=>{V(M),O(!0)},className:"self-start px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-semibold transition-all flex items-center gap-2 text-sm",type:"button"},React.createElement("i",{className:"fas fa-edit"}),"Modifier (Legacy)")))))),React.createElement("div",{className:"p-6 border-t border-gray-200 bg-gray-50 flex justify-end gap-3"},React.createElement("button",{onClick:t,disabled:c,className:"px-6 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-lg font-semibold transition-all",type:"button"},"Annuler"),React.createElement("button",{onClick:async()=>{o(!0);try{await axios.put(API_URL+"/settings/timezone_offset_hours",{value:r}),localStorage.setItem("timezone_offset_hours",r),alert("Paramètres mis à jour avec succès!"),t()}catch(e){alert("Erreur: "+(e.response?.data?.error||"Erreur serveur"))}finally{o(!1)}},disabled:c,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all flex items-center gap-2",type:"button"},c&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),c?"Enregistrement...":"Enregistrer"))))):null};