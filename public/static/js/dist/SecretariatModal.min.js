const SecretariatModal=({isOpen:e,onClose:t})=>{const[a,n]=React.useState("correspondance"),[r,i]=React.useState(""),[o,l]=React.useState(null),[c,s]=React.useState(!1),[d,m]=React.useState(!1),p=[{id:"correspondance",label:"Correspondance",icon:"‚úâÔ∏è",documents:[{icon:"üìß",label:"Lettre officielle",value:"R√©diger une lettre officielle √† [destinataire] concernant : "},{icon:"ü§ù",label:"Lettre de partenariat",value:"Proposition de partenariat commercial avec : "},{icon:"üì¨",label:"R√©ponse fournisseur",value:"R√©ponse √† une demande de fournisseur concernant : "},{icon:"üôè",label:"Lettre de remerciement",value:"Lettre de remerciement adress√©e √† : "}]},{id:"subventions",label:"Subventions",icon:"üí∞",documents:[{icon:"üá®üá¶",label:"Subvention f√©d√©rale (PARI-CNRC)",value:"Demande de subvention au Programme d'aide √† la recherche industrielle (PARI-CNRC) pour le projet : "},{icon:"‚öúÔ∏è",label:"Subvention Qu√©bec (Investissement QC)",value:"Demande de subvention √† Investissement Qu√©bec pour le projet de : "},{icon:"üî¨",label:"Cr√©dit R&D (RS&DE)",value:"Pr√©paration du dossier de cr√©dit d'imp√¥t RS&DE pour les activit√©s de recherche et d√©veloppement : "},{icon:"üå±",label:"Programme √©cologique",value:"Demande au Fonds √âcoleader / Fonds vert pour le projet environnemental : "},{icon:"üë∑",label:"Subvention formation",value:"Demande de subvention √† Emploi-Qu√©bec pour la formation des employ√©s sur : "}]},{id:"administratif",label:"Administratif",icon:"üìÅ",documents:[{icon:"üìú",label:"Proc√®s-verbal",value:"R√©diger le proc√®s-verbal de la r√©union du conseil d'administration du : "},{icon:"üìã",label:"Politique interne",value:"R√©diger une politique interne concernant : "},{icon:"üìë",label:"Contrat type",value:"Pr√©parer un contrat type pour : "},{icon:"‚öñÔ∏è",label:"Mise en demeure",value:"R√©diger une mise en demeure adress√©e √† [nom] pour : "}]},{id:"rh",label:"Ressources Humaines",icon:"üë•",documents:[{icon:"üìÑ",label:"Offre d'emploi",value:"R√©diger une offre d'emploi pour le poste de : "},{icon:"‚úÖ",label:"Lettre d'embauche",value:"Lettre d'offre d'embauche pour [nom] au poste de : "},{icon:"üìù",label:"√âvaluation employ√©",value:"Formulaire d'√©valuation de performance pour : "},{icon:"üö™",label:"Lettre de fin d'emploi",value:"Lettre de fin d'emploi / cessation pour : "}]},{id:"technique",label:"Documents Techniques",icon:"üîß",documents:[{icon:"üìñ",label:"Manuel de proc√©dure",value:"R√©diger un manuel de proc√©dure pour : "},{icon:"üîí",label:"Fiche de s√©curit√©",value:"Fiche de donn√©es de s√©curit√© (FDS) pour le produit : "},{icon:"üìê",label:"Sp√©cification technique",value:"Sp√©cification technique d√©taill√©e pour : "},{icon:"‚úîÔ∏è",label:"Liste de v√©rification",value:"Checklist / liste de v√©rification pour : "}]},{id:"financier",label:"Documents Financiers",icon:"üíº",documents:[{icon:"üíµ",label:"Demande de financement",value:"Demande de financement bancaire pour le projet : "},{icon:"üìä",label:"Plan d'affaires",value:"Section du plan d'affaires concernant : "},{icon:"üßæ",label:"Justificatif de d√©penses",value:"Justificatif de d√©penses pour le projet/subvention : "},{icon:"üìà",label:"Rapport financier",value:"Rapport financier p√©riodique incluant : "}]},{id:"rapports",label:"Rapports",icon:"üìä",documents:[{icon:"üìÖ",label:"Rapport mensuel",value:"G√©n√©rer un rapport mensuel complet sur les op√©rations de maintenance incluant les KPIs cl√©s"},{icon:"üìà",label:"Bilan performance",value:"Analyse de performance de l'√©quipe technique avec temps de r√©ponse et r√©solution"},{icon:"üè≠",label:"√âtat des machines",value:"Rapport sur l'√©tat et la disponibilit√© du parc machines"},{icon:"‚ö†Ô∏è",label:"Incidents critiques",value:"Rapport sur les incidents critiques et pannes majeures"}]},{id:"creatif",label:"Cr√©atif",icon:"üé®",documents:[{icon:"üåê",label:"Texte site web",value:"R√©diger un texte promotionnel pour notre site web pr√©sentant : "},{icon:"üì∞",label:"Communiqu√© de presse",value:"Communiqu√© de presse annon√ßant : "},{icon:"üé§",label:"Discours / Allocution",value:"R√©diger un discours pour [occasion] sur le th√®me : "},{icon:"üì¢",label:"Brochure / D√©pliant",value:"Cr√©er le contenu d'une brochure de pr√©sentation mettant en avant : "},{icon:"üí°",label:"Pitch commercial",value:"R√©diger un pitch commercial pour pr√©senter nos services √† : "},{icon:"üìù",label:"Autre (libre)",value:""}]}],u=e=>e?e.replace(/\|(.+)\|\n\|[-:\s|]+\|\n((?:\|.+\|\n?)+)/g,(e,t,a)=>`<table><thead><tr>${t.split("|").filter(e=>e.trim()).map(e=>`<th>${e.trim()}</th>`).join("")}</tr></thead><tbody>${a.trim().split("\n").map(e=>`<tr>${e.split("|").filter(e=>e.trim()).map(e=>`<td>${e.trim()}</td>`).join("")}</tr>`).join("")}</tbody></table>`).replace(/^### (.+)$/gm,"<h3>$1</h3>").replace(/^## (.+)$/gm,"<h2>$1</h2>").replace(/^# (.+)$/gm,"<h1>$1</h1>").replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>").replace(/\*([^*]+)\*/g,"<em>$1</em>").replace(/^\* (.+)$/gm,"<li>$1</li>").replace(/^- (.+)$/gm,"<li>$1</li>").replace(/(<li>.*<\/li>\n?)+/g,"<ul>$&</ul>").replace(/^\d+\. (.+)$/gm,"<li>$1</li>").replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br>").replace(/^/,"<p>").replace(/$/,"</p>").replace(/<p><\/p>/g,"").replace(/<p>(<h[123]>)/g,"$1").replace(/(<\/h[123]>)<\/p>/g,"$1").replace(/<p>(<ul>)/g,"$1").replace(/(<\/ul>)<\/p>/g,"$1").replace(/<p>(<table>)/g,"$1").replace(/(<\/table>)<\/p>/g,"$1"):"";return e?React.createElement("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",onClick:t},React.createElement("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),React.createElement("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"bg-gradient-to-r from-indigo-600 to-blue-600 px-6 py-4 flex items-center justify-between text-white"},React.createElement("div",{className:"flex items-center gap-3"},React.createElement("div",{className:"w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center"},React.createElement("i",{className:"fas fa-file-signature text-xl"})),React.createElement("div",{},React.createElement("h2",{className:"text-lg font-bold"},"Secr√©tariat"),React.createElement("p",{className:"text-xs text-indigo-200"},"G√©n√©ration de documents professionnels"))),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("button",{onClick:()=>m(!d),className:"p-2 rounded-lg transition-colors "+(d?"bg-white/30":"hover:bg-white/20"),title:"Trucs & Astuces"},React.createElement("i",{className:"fas fa-question-circle"})),React.createElement("button",{onClick:t,className:"p-2 hover:bg-white/20 rounded-lg transition-colors"},React.createElement("i",{className:"fas fa-times"})))),d&&React.createElement("div",{className:"bg-amber-50 border-b border-amber-200 px-6 py-3"},React.createElement("div",{className:"flex items-center gap-2 mb-2"},React.createElement("i",{className:"fas fa-lightbulb text-amber-600"}),React.createElement("span",{className:"text-sm font-semibold text-amber-800"},"Trucs & Astuces")),React.createElement("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-1"},['üí° Soyez pr√©cis : "Lettre au fournisseur ABC pour retard livraison" > "Lettre fournisseur"','üìÖ Incluez les dates : "r√©union du 15 janvier", "projet d√©marr√© en mars 2024"','üí∞ Montants exacts : "subvention de 50 000$", "investissement de 200 000$"','üë§ Nommez les destinataires : "M. Jean Tremblay, Directeur"','üéØ Pr√©cisez l\'objectif : "pour obtenir un financement", "pour relancer la commande"',"üìä L'IA utilise vos donn√©es r√©elles : tickets, machines, √©quipes pour enrichir les documents"].map((e,t)=>React.createElement("li",{key:t,className:"text-xs text-amber-700"},e)))),React.createElement("div",{className:"flex-1 overflow-y-auto p-6"},React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Type de document"),React.createElement("div",{className:"flex flex-wrap gap-2"},p.map(e=>React.createElement("button",{key:e.id,onClick:()=>{n(e.id),i(""),l(null)},className:"flex items-center gap-1.5 px-3 py-2 text-sm rounded-lg transition-all "+(a===e.id?"bg-indigo-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200")},React.createElement("span",{},e.icon),React.createElement("span",{},e.label))))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Mod√®les"),React.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2"},(p.find(e=>e.id===a)?.documents||[]).map((e,t)=>React.createElement("button",{key:t,onClick:()=>i(e.value),className:"flex items-center gap-2 px-3 py-2 text-sm rounded-lg text-left transition-all "+(r===e.value?"bg-indigo-100 text-indigo-800 border-2 border-indigo-300":"bg-white text-gray-700 border border-gray-200 hover:border-indigo-300")},React.createElement("span",{className:"text-base"},e.icon),React.createElement("span",{className:"truncate flex-1"},e.label))))),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Instructions d√©taill√©es"),React.createElement("textarea",{value:r,onChange:e=>i(e.target.value),placeholder:"D√©crivez le document souhait√© avec tous les d√©tails : destinataire, objet, contexte, montants, dates...",rows:4,className:"w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 outline-none resize-none"})),React.createElement("div",{className:"mb-4 p-3 bg-indigo-50 rounded-lg border border-indigo-100"},React.createElement("p",{className:"text-xs text-indigo-700"},React.createElement("span",{className:"font-semibold"},"üí° Connaissances int√©gr√©es : "),"Lois canadiennes et qu√©b√©coises, programmes de subventions (PARI-CNRC, IQ, RS&DE), normes industrielles, donn√©es de vos tickets et machines.")),o&&React.createElement("div",{className:"mt-6 bg-green-50 rounded-xl border border-green-200 overflow-hidden"},React.createElement("div",{className:"bg-green-100 px-4 py-3 flex items-center justify-between"},React.createElement("div",{className:"flex items-center gap-2"},React.createElement("i",{className:"fas fa-check-circle text-green-600"}),React.createElement("span",{className:"font-medium text-green-800"},o.title||"Document g√©n√©r√©")),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("button",{onClick:()=>{o?.document&&navigator.clipboard.writeText(o.document).then(()=>{window.showToast&&window.showToast("Document copi√© !","success")}).catch(()=>{window.showToast&&window.showToast("Erreur lors de la copie","error")})},className:"px-3 py-1.5 text-sm bg-white text-green-700 rounded-lg hover:bg-green-50 border border-green-300 transition-colors",title:"Copier"},React.createElement("i",{className:"fas fa-copy"})),React.createElement("button",{onClick:async()=>{if(!o)return;let e="IGP",t="",a="/api/settings/logo";try{const n=await axios.get("/api/settings/config/public");n.data&&(e=n.data.company_short_name||"IGP",t=n.data.company_subtitle||"",n.data.company_logo_url&&(a=n.data.company_logo_url))}catch(e){console.log("Settings not loaded for print")}const n=(new Date).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}),r=u(o.document),i=o.title||"Document",l=`<!DOCTYPE html>\n<html lang="fr">\n<head>\n<meta charset="UTF-8">\n<title>${i}</title>\n<style>\n@page { size: A4; margin: 0; }\n* { box-sizing: border-box; margin: 0; padding: 0; }\nbody { \n    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;\n    font-size: 11pt; line-height: 1.7; color: #333;\n    padding: 20mm 18mm 25mm 18mm;\n}\n.header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 25pt; padding-bottom: 15pt; border-bottom: 1pt solid #e0e0e0; }\n.header-left { display: flex; align-items: center; }\n.logo { height: 45pt; margin-right: 15pt; }\n.brand { border-left: 2pt solid #4f46e5; padding-left: 15pt; }\n.brand-name { font-size: 16pt; font-weight: 600; color: #1a1a1a; }\n.brand-sub { font-size: 9pt; color: #555; margin-top: 4pt; max-width: 250pt; }\n.header-right { text-align: right; font-size: 10pt; color: #555; }\n.title-block { text-align: center; padding: 20pt 0; margin-bottom: 20pt; border-bottom: 2pt solid #4f46e5; }\n.title-block h1 { font-size: 18pt; font-weight: 700; color: #1a1a1a; }\n.content { font-size: 11pt; line-height: 1.6; }\n.content h1 { font-size: 14pt; font-weight: 700; color: #1a1a1a; margin: 18pt 0 10pt; padding-bottom: 5pt; border-bottom: 1.5pt solid #1a1a1a; }\n.content h2 { font-size: 12pt; font-weight: 600; color: #333; margin: 15pt 0 8pt; padding-left: 8pt; border-left: 2pt solid #4f46e5; }\n.content h3 { font-size: 11pt; font-weight: 600; color: #444; margin: 12pt 0 6pt; }\n.content p { margin-bottom: 10pt; text-align: justify; }\n.content ul, .content ol { margin: 10pt 0 10pt 20pt; }\n.content li { margin-bottom: 5pt; }\n.content strong { color: #1a1a1a; }\n.content table { width: 100%; border-collapse: collapse; margin: 15pt 0; font-size: 10pt; }\n.content th { background: #f0f2f5; border: 1pt solid #ddd; padding: 8pt; text-align: left; font-weight: 600; }\n.content td { border: 1pt solid #ddd; padding: 8pt; }\n.content tr:nth-child(even) { background: #fafafa; }\n.footer { margin-top: 40pt; padding-top: 15pt; border-top: 1pt solid #ddd; font-size: 9pt; color: #666; text-align: center; }\n@media print { \n    body { -webkit-print-color-adjust: exact; print-color-adjust: exact; padding: 20mm 18mm 25mm 18mm !important; }\n    .header, .title-block { page-break-inside: avoid; }\n}\n</style>\n</head>\n<body>\n<div class="header">\n    <div class="header-left">\n        <img src="${a}" class="logo" onerror="this.style.display='none'">\n        <div class="brand">\n            <div class="brand-name">${e}</div>\n            <div class="brand-sub">${t}</div>\n        </div>\n    </div>\n    <div class="header-right">\n        <div>${n}</div>\n    </div>\n</div>\n<div class="title-block">\n    <h1>${i}</h1>\n</div>\n<div class="content">\n    ${r}\n</div>\n<div class="footer">\n    Document g√©n√©r√© par ${e} - Secr√©tariat de Direction\n</div>\n</body>\n</html>`,c=window.open("","_blank","width=800,height=600");c&&(c.document.write(l),c.document.close(),setTimeout(()=>c.print(),300))},className:"px-3 py-1.5 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",title:"Imprimer"},React.createElement("i",{className:"fas fa-print mr-1"}),"Imprimer"))),React.createElement("div",{className:"p-4 max-h-64 overflow-y-auto text-sm text-gray-700 bg-white prose prose-sm",dangerouslySetInnerHTML:{__html:u(o.document)}}))),React.createElement("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end gap-3"},React.createElement("button",{onClick:t,className:"px-4 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"},"Fermer"),React.createElement("button",{onClick:async()=>{if(r.trim()){s(!0),l(null);try{const e=localStorage.getItem("auth_token"),t=await axios.post("/api/ai/secretary",{documentType:a,instructions:r.trim()},{headers:e?{Authorization:`Bearer ${e}`}:{}});if(!1===t.data.success)throw new Error(t.data.error||"Erreur de g√©n√©ration");l(t.data),window.showToast&&window.showToast("Document g√©n√©r√© avec succ√®s","success")}catch(e){console.error("Secretary error:",e),window.showToast&&window.showToast(e.response?.data?.error||"Erreur lors de la g√©n√©ration","error")}finally{s(!1)}}else window.showToast&&window.showToast("Veuillez d√©crire le document souhait√©","warning")},disabled:c||!r.trim(),className:"px-5 py-2.5 text-sm font-medium text-white rounded-lg transition-colors flex items-center gap-2 "+(c||!r.trim()?"bg-gray-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700")},c?React.createElement("i",{className:"fas fa-spinner fa-spin"}):React.createElement("i",{className:"fas fa-magic"}),c?"G√©n√©ration...":"G√©n√©rer le document")))):null};window.SecretariatModal=SecretariatModal;