const SecretariatModal=({isOpen:e,onClose:t})=>{const[a,n]=React.useState("correspondance"),[l,r]=React.useState(""),[i,o]=React.useState(null),[c,s]=React.useState(!1),[d,m]=React.useState("form"),p=[{id:"correspondance",label:"Correspondance",icon:"fa-envelope",color:"blue",documents:[{icon:"fa-file-alt",label:"Lettre officielle",value:"Rédiger une lettre officielle à [destinataire] concernant : "},{icon:"fa-handshake",label:"Lettre de partenariat",value:"Proposition de partenariat commercial avec : "},{icon:"fa-reply",label:"Réponse fournisseur",value:"Réponse à une demande de fournisseur concernant : "},{icon:"fa-heart",label:"Lettre de remerciement",value:"Lettre de remerciement adressée à : "}]},{id:"subventions",label:"Subventions",icon:"fa-dollar-sign",color:"emerald",documents:[{icon:"fa-flag",label:"PARI-CNRC",value:"Demande de subvention au Programme d'aide à la recherche industrielle (PARI-CNRC) pour le projet : "},{icon:"fa-landmark",label:"Investissement Québec",value:"Demande de subvention à Investissement Québec pour le projet de : "},{icon:"fa-flask",label:"Crédit RS&DE",value:"Préparation du dossier de crédit d'impôt RS&DE pour les activités de R&D : "},{icon:"fa-leaf",label:"Fonds écologique",value:"Demande au Fonds Écoleader pour le projet environnemental : "},{icon:"fa-graduation-cap",label:"Formation Emploi-QC",value:"Demande de subvention à Emploi-Québec pour la formation sur : "}]},{id:"administratif",label:"Administratif",icon:"fa-folder",color:"amber",documents:[{icon:"fa-gavel",label:"Procès-verbal",value:"Rédiger le procès-verbal de la réunion du : "},{icon:"fa-clipboard-list",label:"Politique interne",value:"Rédiger une politique interne concernant : "},{icon:"fa-file-contract",label:"Contrat type",value:"Préparer un contrat type pour : "},{icon:"fa-balance-scale",label:"Mise en demeure",value:"Rédiger une mise en demeure adressée à [nom] pour : "}]},{id:"rh",label:"Ressources Humaines",icon:"fa-users",color:"purple",documents:[{icon:"fa-user-plus",label:"Offre d'emploi",value:"Rédiger une offre d'emploi pour le poste de : "},{icon:"fa-file-signature",label:"Lettre d'embauche",value:"Lettre d'offre d'embauche pour [nom] au poste de : "},{icon:"fa-chart-line",label:"Évaluation employé",value:"Formulaire d'évaluation de performance pour : "},{icon:"fa-door-open",label:"Fin d'emploi",value:"Lettre de fin d'emploi pour : "}]},{id:"technique",label:"Technique",icon:"fa-cogs",color:"slate",documents:[{icon:"fa-book",label:"Manuel procédure",value:"Rédiger un manuel de procédure pour : "},{icon:"fa-shield-alt",label:"Fiche sécurité",value:"Fiche de données de sécurité (FDS) pour : "},{icon:"fa-ruler-combined",label:"Spécification technique",value:"Spécification technique détaillée pour : "},{icon:"fa-tasks",label:"Checklist",value:"Liste de vérification pour : "}]},{id:"financier",label:"Financier",icon:"fa-chart-pie",color:"rose",documents:[{icon:"fa-hand-holding-usd",label:"Demande financement",value:"Demande de financement bancaire pour : "},{icon:"fa-briefcase",label:"Plan d'affaires",value:"Section du plan d'affaires concernant : "},{icon:"fa-receipt",label:"Justificatif dépenses",value:"Justificatif de dépenses pour : "},{icon:"fa-file-invoice-dollar",label:"Rapport financier",value:"Rapport financier périodique incluant : "}]},{id:"rapports",label:"Rapports",icon:"fa-chart-bar",color:"indigo",documents:[{icon:"fa-calendar-alt",label:"Rapport mensuel",value:"Générer un rapport mensuel complet sur les opérations de maintenance avec les KPIs clés"},{icon:"fa-tachometer-alt",label:"Bilan performance",value:"Analyse de performance de l'équipe technique avec temps de réponse et résolution"},{icon:"fa-industry",label:"État machines",value:"Rapport sur l'état et la disponibilité du parc machines"},{icon:"fa-exclamation-triangle",label:"Incidents critiques",value:"Rapport sur les incidents critiques et pannes majeures"}]},{id:"creatif",label:"Créatif",icon:"fa-paint-brush",color:"pink",documents:[{icon:"fa-globe",label:"Texte site web",value:"Rédiger un texte promotionnel pour notre site web présentant : "},{icon:"fa-newspaper",label:"Communiqué presse",value:"Communiqué de presse annonçant : "},{icon:"fa-microphone",label:"Discours",value:"Rédiger un discours pour [occasion] sur le thème : "},{icon:"fa-bullhorn",label:"Pitch commercial",value:"Rédiger un pitch commercial pour présenter nos services à : "}]}],u={blue:{bg:"bg-blue-500",light:"bg-blue-50",text:"text-blue-600",border:"border-blue-200",ring:"ring-blue-500"},emerald:{bg:"bg-emerald-500",light:"bg-emerald-50",text:"text-emerald-600",border:"border-emerald-200",ring:"ring-emerald-500"},amber:{bg:"bg-amber-500",light:"bg-amber-50",text:"text-amber-600",border:"border-amber-200",ring:"ring-amber-500"},purple:{bg:"bg-purple-500",light:"bg-purple-50",text:"text-purple-600",border:"border-purple-200",ring:"ring-purple-500"},slate:{bg:"bg-slate-500",light:"bg-slate-50",text:"text-slate-600",border:"border-slate-200",ring:"ring-slate-500"},rose:{bg:"bg-rose-500",light:"bg-rose-50",text:"text-rose-600",border:"border-rose-200",ring:"ring-rose-500"},indigo:{bg:"bg-indigo-500",light:"bg-indigo-50",text:"text-indigo-600",border:"border-indigo-200",ring:"ring-indigo-500"},pink:{bg:"bg-pink-500",light:"bg-pink-50",text:"text-pink-600",border:"border-pink-200",ring:"ring-pink-500"}},f=e=>{if(!e)return"";let t=e.replace(/\|(.+)\|\n\|[-:\s|]+\|\n((?:\|.+\|\n?)+)/g,(e,t,a)=>`<table><thead><tr>${t.split("|").filter(e=>e.trim()).map(e=>`<th>${e.trim()}</th>`).join("")}</tr></thead><tbody>${a.trim().split("\n").map(e=>`<tr>${e.split("|").filter(e=>e.trim()).map(e=>`<td>${e.trim()}</td>`).join("")}</tr>`).join("")}</tbody></table>`).replace(/^#### (.+)$/gm,"<h4>$1</h4>").replace(/^### (.+)$/gm,"<h3>$1</h3>").replace(/^## (.+)$/gm,"<h2>$1</h2>").replace(/^# (.+)$/gm,"<h1>$1</h1>").replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>").replace(/\*([^*]+)\*/g,"<em>$1</em>").replace(/^(\s*)[\*\-] (.+)$/gm,(e,t,a)=>`<li data-level="${Math.floor((t||"").length/2)}">${a}</li>`).replace(/^\d+\. (.+)$/gm,'<li class="numbered">$1</li>');return t=t.replace(/(<li[^>]*>.*<\/li>\n?)+/g,e=>e.includes('class="numbered"')?`<ol>${e}</ol>`:`<ul>${e}</ul>`),t=t.replace(/\n\n+/g,"</p><p>").replace(/\n/g,"<br>").replace(/^/,"<p>").replace(/$/,"</p>").replace(/<p><\/p>/g,"").replace(/<p>(<h[1234]>)/g,"$1").replace(/(<\/h[1234]>)<\/p>/g,"$1").replace(/<p>(<ul>)/g,"$1").replace(/(<\/ul>)<\/p>/g,"$1").replace(/<p>(<ol>)/g,"$1").replace(/(<\/ol>)<\/p>/g,"$1").replace(/<p>(<table>)/g,"$1").replace(/(<\/table>)<\/p>/g,"$1"),t},b="\n        .doc-content { font-family: 'Georgia', 'Times New Roman', serif; font-size: 11pt; line-height: 1.8; color: #1a1a1a; }\n        .doc-content h1 { font-size: 18pt; font-weight: 700; color: #0f172a; margin: 24pt 0 12pt; padding-bottom: 8pt; border-bottom: 2pt solid #3b82f6; }\n        .doc-content h2 { font-size: 14pt; font-weight: 600; color: #1e293b; margin: 20pt 0 10pt; padding-left: 12pt; border-left: 3pt solid #3b82f6; }\n        .doc-content h3 { font-size: 12pt; font-weight: 600; color: #334155; margin: 16pt 0 8pt; }\n        .doc-content h4 { font-size: 11pt; font-weight: 600; color: #475569; margin: 14pt 0 6pt; }\n        .doc-content p { margin: 0 0 12pt; text-align: justify; }\n        .doc-content ul, .doc-content ol { margin: 12pt 0; padding-left: 24pt; }\n        .doc-content li { margin: 6pt 0; }\n        .doc-content strong { font-weight: 700; color: #0f172a; }\n        .doc-content em { font-style: italic; }\n        .doc-content table { width: 100%; border-collapse: collapse; margin: 16pt 0; font-size: 10pt; }\n        .doc-content th { background: #f1f5f9; border: 1pt solid #cbd5e1; padding: 10pt; text-align: left; font-weight: 600; }\n        .doc-content td { border: 1pt solid #cbd5e1; padding: 10pt; }\n        .doc-content tr:nth-child(even) { background: #f8fafc; }\n    ";if(!e)return null;const g=p.find(e=>e.id===a),h=u[g?.color||"indigo"];return"preview"===d&&i?React.createElement("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(15, 23, 42, 0.8)",backdropFilter:"blur(4px)"}},React.createElement("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl h-[90vh] flex flex-col overflow-hidden m-4",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"bg-gradient-to-r from-emerald-600 to-teal-600 px-6 py-4 flex items-center justify-between flex-shrink-0"},React.createElement("div",{className:"flex items-center gap-3 text-white"},React.createElement("i",{className:"fas fa-file-alt text-xl"}),React.createElement("div",{},React.createElement("h2",{className:"text-lg font-bold"},i.title||"Document"),React.createElement("p",{className:"text-xs text-emerald-100"},"Document généré avec succès"))),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("button",{onClick:()=>{i?.document&&navigator.clipboard.writeText(i.document).then(()=>{window.showToast&&window.showToast("Document copié","success")})},className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-white text-sm font-medium transition-all flex items-center gap-2"},React.createElement("i",{className:"fas fa-copy"}),"Copier"),React.createElement("button",{onClick:async()=>{if(!i)return;let e="IGP",t="",a="/api/settings/logo";try{const n=await axios.get("/api/settings/config/public");n.data&&(e=n.data.company_short_name||"IGP",t=n.data.company_subtitle||"",n.data.company_logo_url&&(a=n.data.company_logo_url))}catch(e){}const n=(new Date).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}),l=f(i.document),r=i.title||"Document",o=`<!DOCTYPE html>\n<html lang="fr">\n<head>\n    <meta charset="UTF-8">\n    <title>${r}</title>\n    <style>\n        @page { size: A4; margin: 20mm 18mm 25mm 18mm; }\n        * { box-sizing: border-box; margin: 0; padding: 0; }\n        body { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 11pt; line-height: 1.7; color: #333; }\n        \n        .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 30pt; padding-bottom: 15pt; border-bottom: 1pt solid #e0e0e0; }\n        .header-left { display: flex; align-items: center; }\n        .logo { height: 50pt; margin-right: 15pt; }\n        .brand { border-left: 3pt solid #3b82f6; padding-left: 15pt; }\n        .brand-name { font-size: 18pt; font-weight: 700; color: #0f172a; letter-spacing: -0.5pt; }\n        .brand-sub { font-size: 9pt; color: #64748b; margin-top: 4pt; }\n        .header-right { text-align: right; font-size: 10pt; color: #64748b; }\n        \n        .title-block { text-align: center; padding: 25pt 0; margin-bottom: 25pt; background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); border-radius: 8pt; }\n        .title-block h1 { font-size: 20pt; font-weight: 700; color: #0f172a; margin: 0; }\n        \n        ${b.replace(".doc-content ",".content ")}\n        \n        .footer { margin-top: 40pt; padding-top: 15pt; border-top: 1pt solid #e2e8f0; font-size: 9pt; color: #94a3b8; text-align: center; }\n        \n        @media print {\n            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }\n            .header, .title-block { page-break-inside: avoid; }\n            h1, h2, h3, h4 { page-break-after: avoid; }\n        }\n    </style>\n</head>\n<body>\n    <div class="header">\n        <div class="header-left">\n            <img src="${a}" class="logo" onerror="this.style.display='none'">\n            <div class="brand">\n                <div class="brand-name">${e}</div>\n                <div class="brand-sub">${t}</div>\n            </div>\n        </div>\n        <div class="header-right">\n            <div style="font-weight: 600; color: #334155;">${n}</div>\n        </div>\n    </div>\n    \n    <div class="title-block">\n        <h1>${r}</h1>\n    </div>\n    \n    <div class="content">${l}</div>\n    \n    <div class="footer">\n        Document généré par ${e} — Secrétariat de Direction\n    </div>\n</body>\n</html>`,c=window.open("","_blank");c?(c.document.write(o),c.document.close(),c.onload=()=>{setTimeout(()=>{c.focus(),c.print()},250)}):window.showToast&&window.showToast("Popup bloquée. Autorisez les popups pour imprimer.","error")},className:"px-4 py-2 bg-white text-emerald-600 rounded-lg text-sm font-semibold hover:bg-emerald-50 transition-all flex items-center gap-2"},React.createElement("i",{className:"fas fa-print"}),"Imprimer"),React.createElement("button",{onClick:t,className:"ml-2 w-9 h-9 rounded-lg bg-white/20 hover:bg-white/30 flex items-center justify-center text-white transition-all"},React.createElement("i",{className:"fas fa-times"})))),React.createElement("div",{className:"flex-1 overflow-y-auto bg-slate-100 p-6"},React.createElement("div",{className:"bg-white rounded-xl shadow-lg max-w-3xl mx-auto"},React.createElement("div",{className:"p-8 md:p-12"},React.createElement("style",{},b),React.createElement("div",{className:"doc-content",dangerouslySetInnerHTML:{__html:f(i.document)}})))),React.createElement("div",{className:"px-6 py-4 bg-white border-t border-slate-200 flex items-center justify-between flex-shrink-0"},React.createElement("button",{onClick:()=>{o(null),m("form"),r("")},className:"px-5 py-2.5 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-xl transition-all flex items-center gap-2"},React.createElement("i",{className:"fas fa-plus"}),"Nouveau document"),React.createElement("button",{onClick:t,className:"px-5 py-2.5 text-sm font-medium text-white bg-slate-800 hover:bg-slate-900 rounded-xl transition-all"},"Fermer")))):React.createElement("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(15, 23, 42, 0.7)",backdropFilter:"blur(4px)"}},React.createElement("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[92vh] flex flex-col overflow-hidden m-4",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 px-8 py-5 flex items-center justify-between flex-shrink-0"},React.createElement("div",{className:"flex items-center gap-4"},React.createElement("div",{className:"w-12 h-12 rounded-xl bg-white/10 flex items-center justify-center"},React.createElement("i",{className:"fas fa-file-signature text-2xl text-white"})),React.createElement("div",{},React.createElement("h2",{className:"text-xl font-bold text-white tracking-tight"},"Secrétariat de Direction"),React.createElement("p",{className:"text-sm text-slate-400"},"Génération de documents professionnels"))),React.createElement("button",{onClick:t,className:"w-10 h-10 rounded-xl bg-white/10 hover:bg-white/20 flex items-center justify-center text-white transition-all"},React.createElement("i",{className:"fas fa-times"}))),React.createElement("div",{className:"flex flex-1 overflow-hidden"},React.createElement("div",{className:"w-52 bg-slate-50 border-r border-slate-200 p-3 overflow-y-auto flex-shrink-0"},React.createElement("div",{className:"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 px-2"},"Catégories"),p.map(e=>{const t=u[e.color],l=a===e.id;return React.createElement("button",{key:e.id,onClick:()=>{n(e.id),r("")},className:"w-full flex items-center gap-2.5 px-2.5 py-2 rounded-lg mb-0.5 transition-all text-left "+(l?`${t.light} ${t.text}`:"hover:bg-slate-100 text-slate-600")},React.createElement("div",{className:`w-7 h-7 rounded-lg ${l?t.bg:"bg-slate-200"} flex items-center justify-center transition-all`},React.createElement("i",{className:`fas ${e.icon} text-xs ${l?"text-white":"text-slate-500"}`})),React.createElement("span",{className:"text-sm font-medium"},e.label))})),React.createElement("div",{className:"flex-1 flex flex-col overflow-hidden"},React.createElement("div",{className:"p-5 border-b border-slate-200 bg-white flex-shrink-0"},React.createElement("div",{className:"flex items-center gap-2 mb-3"},React.createElement("i",{className:`fas ${g?.icon} ${h.text}`}),React.createElement("h3",{className:"text-base font-semibold text-slate-800"},g?.label)),React.createElement("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-2"},(g?.documents||[]).map((e,t)=>{const a=l===e.value;return React.createElement("button",{key:t,onClick:()=>r(e.value),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-left transition-all text-sm "+(a?`${h.light} ${h.text} ring-1 ${h.ring}`:"bg-slate-50 hover:bg-slate-100 text-slate-700")},React.createElement("i",{className:`fas ${e.icon} text-xs ${a?h.text:"text-slate-400"}`}),React.createElement("span",{className:"truncate"},e.label))}))),React.createElement("div",{className:"flex-1 p-5 overflow-y-auto bg-slate-50"},React.createElement("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-2"},React.createElement("i",{className:"fas fa-pen text-slate-400"}),"Instructions détaillées"),React.createElement("textarea",{value:l,onChange:e=>r(e.target.value),placeholder:"Décrivez précisément le document souhaité : destinataire, objet, contexte, montants, dates...",rows:6,className:"w-full px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-slate-400 focus:ring-4 focus:ring-slate-100 outline-none resize-none text-slate-700 placeholder-slate-400 bg-white transition-all"}),React.createElement("p",{className:"mt-3 text-xs text-slate-500"},React.createElement("i",{className:"fas fa-info-circle mr-1"}),"L'IA utilise les lois CA/QC, programmes de subventions et vos données opérationnelles.")),React.createElement("div",{className:"px-5 py-4 bg-white border-t border-slate-200 flex items-center justify-end gap-3 flex-shrink-0"},React.createElement("button",{onClick:t,className:"px-5 py-2.5 text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-xl transition-all"},"Annuler"),React.createElement("button",{onClick:async()=>{if(l.trim()){s(!0),o(null);try{const e=localStorage.getItem("auth_token"),t=await axios.post("/api/ai/secretary",{documentType:a,instructions:l.trim()},{headers:e?{Authorization:`Bearer ${e}`}:{}});if(!1===t.data.success)throw new Error(t.data.error||"Erreur");o(t.data),m("preview"),window.showToast&&window.showToast("Document généré","success")}catch(e){window.showToast&&window.showToast(e.response?.data?.error||"Erreur lors de la génération","error")}finally{s(!1)}}else window.showToast&&window.showToast("Veuillez décrire le document souhaité","warning")},disabled:c||!l.trim(),className:"px-6 py-2.5 text-sm font-semibold text-white rounded-xl transition-all flex items-center gap-2 "+(c||!l.trim()?"bg-slate-300 cursor-not-allowed":"bg-gradient-to-r from-indigo-600 to-blue-600 hover:from-indigo-700 hover:to-blue-700 shadow-lg shadow-indigo-500/25")},c?React.createElement("i",{className:"fas fa-circle-notch fa-spin"}):React.createElement("i",{className:"fas fa-wand-magic-sparkles"}),c?"Génération en cours...":"Générer le document"))))))};window.SecretariatModal=SecretariatModal;