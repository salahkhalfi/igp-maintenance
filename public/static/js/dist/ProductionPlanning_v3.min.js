const ProductionPlanning=({onClose:e})=>{const[t,a]=React.useState(new Date),[r,l]=React.useState("all"),[n,s]=React.useState("calendar"),[o,c]=React.useState([{id:"prod",label:"Production",icon:"fa-industry",color:"blue"},{id:"maint",label:"Maintenance",icon:"fa-tools",color:"orange"},{id:"log",label:"Logistique",icon:"fa-truck",color:"purple"},{id:"qual",label:"Qualité",icon:"fa-clipboard-check",color:"green"},{id:"sst",label:"SST / Sécurité",icon:"fa-hard-hat",color:"red"},{id:"admin",label:"Admin / RH",icon:"fa-users",color:"gray"}]),[i,d]=React.useState(!1),[m,g]=React.useState(null),[u,p]=React.useState([]),[b,f]=React.useState([]),[x,h]=React.useState(!1),w=()=>{h(!0),axios.get("/api/planning?t="+Date.now()).then(e=>{const t=e.data;t.categories&&Array.isArray(t.categories)&&t.categories.length>0&&c(t.categories),t.events&&p(t.events),t.notes&&f(t.notes)}).catch(e=>{console.error("Error loading planning data:",e)}).finally(()=>{h(!1)})};React.useEffect(()=>{w()},[]);const y=(e,t)=>{const a=o.find(t=>t.id===e),r={blue:"bg-blue-50 text-blue-900 border-blue-600",green:"bg-green-50 text-green-900 border-green-600",red:"bg-red-50 text-red-900 border-red-600",yellow:"bg-yellow-50 text-yellow-900 border-yellow-500",purple:"bg-purple-50 text-purple-900 border-purple-600",orange:"bg-orange-50 text-orange-900 border-orange-600",gray:"bg-gray-100 text-gray-800 border-gray-400"},l=r[a?a.color:"gray"]||r.gray;return"tentative"===t?`${l} border-dashed opacity-80 border-l-4`:`${l} border-solid border-l-4`},v=e=>{const t=o.find(t=>t.id===e);return t?t.icon:"fa-circle"},[R,E]=React.useState(null),[N,S]=React.useState(!1),[k,D]=React.useState(!1),[C,M]=React.useState("undefined"!=typeof Notification?Notification.permission:"default");React.useEffect(()=>{if("granted"!==C)return;const e=setInterval(()=>{const e=new Date,t=`${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`;f(e=>{let a=!1;const r=e.map(e=>e.done||e.notified||e.time!==t?e:(new Notification("Rappel IGP Production",{body:e.text,icon:"https://cdn-icons-png.flaticon.com/512/1028/1028918.png"}),a=!0,{...e,notified:!0}));return a?r:e})},3e4);return()=>clearInterval(e)},[C]);const $=(e,t)=>{f(a=>a.map(a=>a.id===e?{...a,...t}:a)),axios.put(`/api/planning/notes/${e}`,t).then(t=>{t.data.note&&f(a=>a.map(a=>a.id===e?t.data.note:a))}).catch(a=>{console.error("Error updating note:",a),alert("Erreur lors de la mise à jour : "+(a.response?.data?.error||a.message)),f(a=>a.map(a=>a.id===e?{...a,is_dashboard:!t.is_dashboard}:a))})},[j,P]=React.useState(!1),[_,A]=React.useState(null),[F,I]=React.useState(""),q=(e,t)=>{e.stopPropagation(),A(t),I(t.date),P(!0)},z=e=>{e.target.style.opacity="1",E(null)},L=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},O=t.getFullYear(),T=t.getMonth(),V=new Date(O,T+1,0).getDate(),Y=Array.from({length:V},(e,t)=>{const a=t+1,r=new Date(O,T,a);return{num:a,dateStr:`${O}-${String(T+1).padStart(2,"0")}-${String(a).padStart(2,"0")}`,dayOfWeek:r.getDay()}});return React.createElement("div",{className:"fixed inset-0 z-[150] bg-gray-100 flex flex-col animate-fadeIn"},React.createElement("div",{className:"bg-white border-b p-3 lg:px-6 lg:py-3 flex flex-col md:flex-row justify-between items-start md:items-center gap-3 md:gap-0 shadow-sm z-20 shrink-0"},React.createElement("div",{className:"flex-1 min-w-0 w-full md:w-auto"},React.createElement("h1",{className:"text-lg lg:text-2xl font-bold text-slate-800 flex items-center gap-2 lg:gap-3 truncate"},React.createElement("div",{className:"bg-blue-600 text-white w-8 h-8 rounded-lg flex items-center justify-center shadow-sm shrink-0"},React.createElement("i",{className:"far fa-calendar-alt text-lg"})),React.createElement("span",{className:"truncate"},"Planning & Production")),React.createElement("div",{className:"flex items-center gap-2 text-xs text-slate-500 mt-1"},React.createElement("span",null,"IGP Glass"),React.createElement("i",{className:"fas fa-circle text-[4px] text-slate-300"}),React.createElement("span",null,"Vue Directeur"))),React.createElement("div",{className:"flex items-center justify-between md:justify-end gap-2 w-full md:w-auto"},React.createElement("div",{className:"flex items-center gap-2"},React.createElement("button",{onClick:()=>d(!0),className:"w-10 h-10 flex items-center justify-center rounded-lg bg-white border border-slate-200 text-slate-600 hover:bg-slate-50 transition shadow-sm"},React.createElement("i",{className:"fas fa-cog"})),React.createElement("button",{onClick:()=>S(!N),className:"lg:hidden w-10 h-10 flex items-center justify-center rounded-lg transition "+(N?"bg-yellow-100 text-yellow-600":"bg-gray-100 text-gray-500")},React.createElement("i",{className:"fas fa-sticky-note"}))),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("button",{onClick:w,title:"Rafraîchir les données",className:"w-10 h-10 flex items-center justify-center rounded-lg bg-white border border-slate-200 text-slate-600 hover:bg-slate-50 transition shadow-sm"},React.createElement("i",{className:"fas fa-sync-alt "+(x?"fa-spin text-blue-600":"")})),React.createElement("button",{onClick:()=>D(!0),title:"Partager le planning",className:"w-10 h-10 flex items-center justify-center rounded-lg bg-white border border-slate-200 text-slate-600 hover:bg-blue-50 hover:text-blue-600 transition shadow-sm"},React.createElement("i",{className:"fas fa-share-alt"})),React.createElement("button",{onClick:()=>s("calendar"===n?"list":"calendar"),title:"calendar"===n?"Passer en vue TV / Liste":"Passer en vue Calendrier",className:"w-10 h-10 flex items-center justify-center rounded-lg border transition shadow-sm "+("list"===n?"bg-slate-800 text-white border-slate-900":"bg-white border-slate-200 text-slate-600 hover:bg-slate-50")},React.createElement("i",{className:"calendar"===n?"fas fa-tv":"fas fa-calendar-alt"})),React.createElement("button",{onClick:()=>{const e=new Date,a=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(Math.max(1,Math.min(e.getDate(),V))).padStart(2,"0")}`;I(a),A(null),P(!0)},className:"flex px-3 lg:px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg shadow-md transition font-semibold items-center gap-2"},React.createElement("i",{className:"fas fa-plus"}),React.createElement("span",{className:"hidden sm:inline"},"Nouvel Événement")),React.createElement("div",{className:"h-8 w-px bg-gray-200 mx-1 hidden md:block"}),React.createElement("button",{onClick:e,className:"bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 px-4 py-2 rounded-lg font-medium transition shadow-sm"},"Fermer")))),React.createElement("div",{className:"bg-white border-b py-2 px-2 lg:px-6 flex flex-col lg:flex-row gap-3 lg:gap-4 items-stretch lg:items-center shadow-sm z-10 shrink-0"},React.createElement("div",{className:"flex items-center overflow-hidden w-full lg:w-auto min-w-0"},React.createElement("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mr-2 shrink-0 hidden lg:inline"},"Filtres :"),React.createElement("div",{className:"flex overflow-x-auto gap-2 items-center pb-2 lg:pb-0 w-full no-scrollbar mask-linear-fade",style:{scrollbarWidth:"none",msOverflowStyle:"none",WebkitOverflowScrolling:"touch"}},React.createElement("button",{onClick:()=>l("all"),className:"px-4 py-2 rounded-full text-sm font-bold transition-all duration-200 border whitespace-nowrap flex-shrink-0 "+("all"===r?"bg-slate-800 text-white border-slate-900 shadow-md transform scale-105":"bg-white text-slate-600 border-slate-300 hover:border-slate-400 shadow-sm")},"Tout Voir"),0===o.length?React.createElement("span",{className:"text-xs text-gray-400 italic whitespace-nowrap px-2"},"Aucune catégorie"):null,o.map(e=>{const t={blue:r===e.id?"bg-blue-600 text-white border-blue-700 shadow-md transform scale-105":"bg-blue-50 text-blue-700 border-blue-200 hover:bg-blue-100",green:r===e.id?"bg-green-600 text-white border-green-700 shadow-md transform scale-105":"bg-green-50 text-green-700 border-green-200 hover:bg-green-100",red:r===e.id?"bg-red-600 text-white border-red-700 shadow-md transform scale-105":"bg-red-50 text-red-700 border-red-200 hover:bg-red-100",yellow:r===e.id?"bg-yellow-500 text-white border-yellow-600 shadow-md transform scale-105":"bg-yellow-50 text-yellow-700 border-yellow-200 hover:bg-yellow-100",purple:r===e.id?"bg-purple-600 text-white border-purple-700 shadow-md transform scale-105":"bg-purple-50 text-purple-700 border-purple-200 hover:bg-purple-100",orange:r===e.id?"bg-orange-600 text-white border-orange-700 shadow-md transform scale-105":"bg-orange-50 text-orange-800 border-orange-200 hover:bg-orange-100",gray:r===e.id?"bg-gray-600 text-white border-gray-700 shadow-md transform scale-105":"bg-gray-100 text-gray-700 border-gray-200 hover:bg-gray-200"},a=t[e.color]||t.gray;return React.createElement("button",{key:e.id,onClick:()=>l(e.id),className:`px-4 py-2 rounded-full text-sm font-bold transition-all duration-200 flex items-center gap-2 border whitespace-nowrap flex-shrink-0 ${a}`},React.createElement("i",{className:`fas ${e.icon} ${r===e.id?"text-white":""} text-sm`}),e.label)}))),React.createElement("div",{className:"flex justify-center lg:justify-end lg:ml-auto shrink-0"},React.createElement("div",{className:"flex bg-gray-100 rounded-lg p-1 shadow-inner"},React.createElement("button",{onClick:()=>{a(new Date(t.getFullYear(),t.getMonth()-1,1))},className:"w-10 h-8 flex items-center justify-center bg-white shadow-sm rounded text-slate-700 hover:bg-slate-50 active:scale-95 transition"},React.createElement("i",{className:"fas fa-chevron-left"})),React.createElement("span",{className:"px-4 flex items-center justify-center font-bold text-slate-700 text-sm whitespace-nowrap capitalize w-36"},t.toLocaleDateString("fr-FR",{month:"long",year:"numeric"})),React.createElement("button",{onClick:()=>{a(new Date(t.getFullYear(),t.getMonth()+1,1))},className:"w-10 h-8 flex items-center justify-center bg-white shadow-sm rounded text-slate-700 hover:bg-slate-50 active:scale-95 transition"},React.createElement("i",{className:"fas fa-chevron-right"}))))),React.createElement("div",{className:"flex-1 flex flex-col lg:flex-row overflow-hidden relative"},"list"===n?React.createElement("div",{className:"flex-1 flex flex-col bg-slate-50 lg:border-r border-gray-200 overflow-y-auto p-4 lg:p-8"},React.createElement("div",{className:"max-w-5xl mx-auto w-full space-y-8"},(()=>{const e=u.filter(e=>{const a=new Date(e.date);return a.getMonth()===t.getMonth()&&a.getFullYear()===t.getFullYear()&&("all"===r||e.type===r)}).sort((e,t)=>new Date(e.date)-new Date(t.date));if(0===e.length)return React.createElement("div",{className:"text-center py-20 text-gray-400"},React.createElement("i",{className:"fas fa-calendar-times text-6xl mb-4 opacity-50"}),React.createElement("p",{className:"text-xl font-medium"},"Aucun événement pour ce mois"));const a=e.reduce((e,t)=>(e[t.date]||(e[t.date]=[]),e[t.date].push(t),e),{});return Object.keys(a).map(e=>{const t=new Date(e),r=t.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"});return React.createElement("div",{key:e,className:"animate-slideIn"},React.createElement("h3",{className:"text-2xl font-bold text-slate-800 mb-4 capitalize flex items-center gap-3 border-b border-slate-200 pb-2"},React.createElement("span",{className:"text-blue-600"},t.getDate()),r),React.createElement("div",{className:"grid gap-4"},a[e].map(e=>{const t=o.find(t=>t.id===e.type),a=y(e.type,e.status);return React.createElement("div",{key:e.id,onClick:t=>q(t,e),className:`bg-white rounded-xl shadow-sm border-l-8 p-6 cursor-pointer hover:shadow-lg transition-all ${a.replace("border-l-4","border-l-8")}`},React.createElement("div",{className:"flex flex-col md:flex-row md:items-start justify-between gap-4"},React.createElement("div",{className:"flex-1"},React.createElement("div",{className:"flex items-center gap-3 mb-2"},React.createElement("span",{className:"px-3 py-1 rounded-full text-sm font-bold uppercase tracking-wider flex items-center gap-2 w-fit "+("blue"===t?.color?"bg-blue-100 text-blue-800":"green"===t?.color?"bg-green-100 text-green-800":"red"===t?.color?"bg-red-100 text-red-800":"yellow"===t?.color?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800")},React.createElement("i",{className:`fas ${t?.icon||"fa-circle"}`}),t?.label||"Autre"),"tentative"===e.status&&React.createElement("span",{className:"text-amber-500 font-bold text-sm flex items-center gap-1"},React.createElement("i",{className:"fas fa-question-circle"}),"À confirmer")),React.createElement("h4",{className:"text-2xl font-bold text-slate-900 mb-2 leading-snug flex items-center gap-2"},e.time&&React.createElement("span",{className:"text-lg font-mono font-normal text-slate-500 bg-slate-100 px-2 py-0.5 rounded"},e.time),e.title),e.details&&React.createElement("div",{className:"text-lg text-slate-600 leading-relaxed bg-slate-50 p-4 rounded-lg border border-slate-100 mt-2"},e.details.split("\n").map((e,t)=>React.createElement("p",{key:t,className:"mb-1 last:mb-0"},e)))),React.createElement("div",{className:"flex items-center gap-2 md:flex-col shrink-0"},React.createElement("button",{className:"w-12 h-12 flex items-center justify-center rounded-full bg-slate-100 text-slate-400 hover:bg-blue-50 hover:text-blue-600 transition"},React.createElement("i",{className:"fas fa-pen text-xl"})))))})))})})())):React.createElement("div",{className:"flex-1 flex flex-col bg-slate-50 lg:border-r border-gray-200 overflow-hidden"},React.createElement("div",{className:"hidden lg:grid grid-cols-7 border-b bg-white shadow-sm"},["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"].map(e=>React.createElement("div",{key:e,className:"py-3 text-center text-xs font-bold text-slate-400 uppercase tracking-wider"},e))),React.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-7 flex-1 overflow-y-auto p-3 lg:p-4 gap-3 lg:gap-4 pb-20 lg:pb-4"},Array.from({length:new Date(O,T,1).getDay()}).map((e,t)=>React.createElement("div",{key:`empty-${t}`,className:"hidden lg:block bg-transparent"})),Y.map((e,a)=>{const l=(n=e.dateStr,u.filter(e=>e.date===n&&("all"===r||e.type==r)));var n;return React.createElement("div",{key:e.dateStr,onDragOver:L,onDrop:t=>((e,t)=>{e.preventDefault(),R&&t&&(p(e=>e.map(e=>e.id===R?{...e,date:t}:e)),axios.put(`/api/planning/events/${R}`,{date:t}).catch(e=>console.error("Error moving event:",e)))})(t,e.dateStr),className:"rounded-xl border bg-white border-slate-200 hover:shadow-md hover:border-blue-300 p-3 flex flex-col gap-2 relative transition-all group min-h-[140px]"},React.createElement("div",{className:"flex justify-between items-start mb-1"},React.createElement("div",{className:"flex items-center gap-2"},React.createElement("span",{className:"text-lg font-bold w-8 h-8 flex items-center justify-center rounded-full "+(e.num===(new Date).getDate()&&t.getMonth()===(new Date).getMonth()?"bg-blue-600 text-white shadow-md":"text-slate-700 bg-slate-100")},e.num),React.createElement("span",{className:"lg:hidden text-sm font-bold text-slate-500 uppercase"},["Dim","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Sam"][e.dayOfWeek])),React.createElement("div",{className:"flex items-center gap-1"},l.length>0&&React.createElement("span",{className:"text-[10px] font-bold text-slate-500 bg-slate-100 border border-slate-200 px-1.5 py-0.5 rounded-md"},`${l.length}`),React.createElement("button",{onClick:()=>{A(null),I(e.dateStr),P(!0)},className:"opacity-100 lg:opacity-0 lg:group-hover:opacity-100 text-slate-400 hover:text-blue-600 transition p-1"},React.createElement("i",{className:"fas fa-plus-circle text-lg"})))),React.createElement("div",{className:"flex-1 overflow-y-auto space-y-1 custom-scrollbar"},l.map((e,t)=>React.createElement("div",{key:e.id||t,draggable:!0,onClick:t=>q(t,e),onDragStart:t=>((e,t)=>{E(t),e.dataTransfer.effectAllowed="move",e.target.style.opacity="0.5"})(t,e.id),onDragEnd:z,className:`text-xs p-2 rounded-lg shadow-sm cursor-pointer hover:scale-[1.02] transition-transform border border-transparent ${y(e.type,e.status)}`,title:"Cliquez pour modifier"},React.createElement("div",{className:"flex items-center justify-between mb-0.5"},React.createElement("div",{className:"flex items-center gap-1.5"},React.createElement("i",{className:`fas ${v(e.type)}`}),React.createElement("span",{className:"font-bold truncate max-w-[80px]"},o.find(t=>t.id===e.type)?.label||"Autre")),"tentative"===e.status&&React.createElement("i",{className:"fas fa-question-circle opacity-50"})),React.createElement("div",{className:"truncate font-medium leading-tight"},e.time&&React.createElement("span",{className:"mr-1 font-mono text-[10px] opacity-75 bg-white/50 px-1 rounded"},e.time),e.title),e.details&&React.createElement("div",{className:"text-[10px] opacity-75 truncate mt-0.5"},e.details)))))}))),"calendar"===n?React.createElement(window.PlanningNotes,{notes:b,showMobile:N,onCloseMobile:()=>S(!1),onAdd:e=>{e.preventDefault();const t=new FormData(e.target),a=t.get("text"),r=t.get("time"),l=t.get("date"),n="on"===t.get("is_dashboard");if(!a)return;const s={id:Date.now(),text:a,time:r,date:l,done:!1,priority:"medium",notified:!1,is_dashboard:n};f(e=>[...e,s]),axios.post("/api/planning/notes",s).then(e=>{const t=e.data;f(e=>e.map(e=>e.id===s.id?t:e))}).catch(e=>{console.error("Error adding note:",e),alert("Erreur lors de l'ajout : "+(e.response?.data?.error||e.message)),f(e=>e.filter(e=>e.id!==s.id))}),e.target.reset()},onUpdate:$,onToggle:e=>{const t=b.find(t=>t.id===e);t&&$(e,{done:!t.done})},onDelete:e=>{f(b.filter(t=>t.id!==e)),axios.delete(`/api/planning/notes/${e}`).catch(e=>console.error("Error deleting note:",e))},notificationPerm:C,onRequestPerm:()=>{"Notification"in window?Notification.requestPermission().then(e=>{M(e),"granted"===e&&new Notification("Notifications activées",{body:"Vous recevrez désormais des alertes pour vos tâches.",icon:"/favicon.ico"})}):alert("Ce navigateur ne supporte pas les notifications desktop")}}):null),React.createElement(window.PlanningModals,{showAddModal:j,setShowAddModal:P,selectedEvent:_,newEventDate:F,categories:o,onSaveEvent:e=>{e.preventDefault();const t=new FormData(e.target),a=t.get("date"),r="on"===t.get("show_on_tv"),l="on"===t.get("is_popup"),n=t.get("image_url"),s=t.get("display_duration");if(_){const e={date:a,time:t.get("time"),type:t.get("type"),title:t.get("title"),details:t.get("details"),show_on_tv:r,is_popup:l,image_url:n,display_duration:s?parseInt(s):15};p(t=>t.map(t=>t.id===_.id?{...t,...e}:t)),axios.put(`/api/planning/events/${_.id}`,e).catch(e=>console.error("Error updating event:",e))}else{const e={id:Date.now(),date:a,time:t.get("time"),type:t.get("type"),status:"confirmed",title:t.get("title"),details:t.get("details"),show_on_tv:r,is_popup:l,image_url:n,display_duration:s?parseInt(s):15};p([...u,e]),axios.post("/api/planning/events",e).then(t=>{const a=t.data;p(t=>t.map(t=>t.id===e.id?a:t))}).catch(e=>console.error("Error creating event:",e))}P(!1),A(null)},onDeleteEvent:()=>{_&&(p(e=>e.filter(e=>e.id!==_.id)),axios.delete(`/api/planning/events/${_.id}`).catch(e=>console.error("Error deleting event:",e)),P(!1),A(null))},showCategoryModal:i,setShowCategoryModal:d,editingCategory:m,onEditCategoryClick:e=>{g(e)},onCancelEditCategory:()=>{g(null)},onDeleteCategory:e=>{confirm("Supprimer cette catégorie ? Les événements existants perdront leur style.")&&(c(o.filter(t=>t.id!==e)),m&&m.id===e&&g(null),axios.delete(`/api/planning/categories/${e}`).catch(e=>console.error("Error deleting category:",e)))},onSaveCategory:e=>{e.preventDefault();const t=new FormData(e.target);if(m){const e={label:t.get("label"),color:t.get("color"),icon:t.get("icon")};c(o.map(t=>t.id===m.id?{...t,...e}:t)),g(null),axios.put(`/api/planning/categories/${m.id}`,e).catch(e=>console.error("Error updating category:",e))}else{const e={id:"cat_"+Date.now(),label:t.get("label"),color:t.get("color"),icon:t.get("icon")};c([...o,e]),axios.post("/api/planning/categories",e).catch(e=>console.error("Error creating category:",e))}e.target.reset()}}),k&&React.createElement(ShareModal,{onClose:()=>D(!1),onShare:async(e,t)=>{try{await axios.post("/api/planning/share",{targetUserId:e,message:t}),alert("Invitation envoyée avec succès !")}catch(e){throw console.error(e),alert("Erreur lors de l'envoi : "+(e.response?.data?.error||e.message)),e}}}))},ShareModal=({onClose:e,onShare:t})=>{const[a,r]=React.useState([]),[l,n]=React.useState(""),[s,o]=React.useState(""),[c,i]=React.useState(!0),[d,m]=React.useState(!1),[g,u]=React.useState(null);return React.useEffect(()=>{axios.get("/api/messages/available-users").then(e=>{r(e.data.users||[]),i(!1)}).catch(e=>{console.error("Error fetching users:",e),u("Impossible de charger les utilisateurs"),i(!1)})},[]),React.createElement("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-fadeIn"},React.createElement("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden animate-slideUp"},React.createElement("div",{className:"p-4 border-b flex justify-between items-center bg-gray-50"},React.createElement("h3",{className:"font-bold text-gray-800 flex items-center gap-2"},React.createElement("i",{className:"fas fa-share-alt text-blue-600"}),"Partager le planning"),React.createElement("button",{onClick:e,className:"text-gray-400 hover:text-gray-600"},React.createElement("i",{className:"fas fa-times"}))),React.createElement("form",{onSubmit:async a=>{if(a.preventDefault(),l){m(!0);try{await t(l,s),e()}catch(e){u("Erreur lors du partage"),m(!1)}}},className:"p-6"},g&&React.createElement("div",{className:"mb-4 p-3 bg-red-50 text-red-600 rounded-md text-sm"},g),React.createElement("div",{className:"mb-4"},React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Destinataire"),c?React.createElement("div",{className:"text-sm text-gray-500"},"Chargement..."):React.createElement("select",{className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 outline-none",value:l,onChange:e=>n(e.target.value),required:!0},React.createElement("option",{value:""},"-- Sélectionner un utilisateur --"),a.map(e=>React.createElement("option",{key:e.id,value:e.id},e.full_name||e.email)))),React.createElement("div",{className:"mb-6"},React.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Message (optionnel)"),React.createElement("textarea",{className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 outline-none text-sm",rows:3,value:s,onChange:e=>o(e.target.value),placeholder:"Je vous invite à consulter le planning de production..."})),React.createElement("div",{className:"flex justify-end gap-3"},React.createElement("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-md"},"Annuler"),React.createElement("button",{type:"submit",disabled:!l||d,className:"px-4 py-2 text-sm text-white bg-blue-600 hover:bg-blue-700 rounded-md shadow-sm flex items-center gap-2 "+(d?"opacity-70 cursor-not-allowed":"")},d&&React.createElement("i",{className:"fas fa-spinner fa-spin"}),"Envoyer l'invitation")))))};window.ProductionPlanning=ProductionPlanning;