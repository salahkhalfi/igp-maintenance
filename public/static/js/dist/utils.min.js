const getNowEST=()=>{const e=parseInt(localStorage.getItem("timezone_offset_hours")||"-5"),t=new Date;return new Date(t.getTime()+60*e*60*1e3)},hasScheduledDate=e=>e&&"null"!==e&&""!==e,formatDateEST=(e,t=!0)=>{if(!e)return"";const r=e.includes("T")?e:e.replace(" ","T"),n=new Date(r+(r.includes("Z")?"":"Z")),a=parseInt(localStorage.getItem("timezone_offset_hours")||"-5"),o=new Date(n.getTime()+60*a*60*1e3),s=String(o.getUTCDate()).padStart(2,"0"),i=String(o.getUTCMonth()+1).padStart(2,"0"),l=o.getUTCFullYear();return t?s+"-"+i+"-"+l+" "+String(o.getUTCHours()).padStart(2,"0")+":"+String(o.getUTCMinutes()).padStart(2,"0"):s+"-"+i+"-"+l},localDateTimeToUTC=e=>{if(!e)return null;const t=e.split("T"),r=t[0].split("-"),n=t[1].split(":"),a=parseInt(r[0]),o=parseInt(r[1])-1,s=parseInt(r[2]),i=parseInt(n[0]),l=parseInt(n[1]),g=i-parseInt(localStorage.getItem("timezone_offset_hours")||"-5"),c=new Date(Date.UTC(a,o,s,g,l,0));return c.getUTCFullYear()+"-"+String(c.getUTCMonth()+1).padStart(2,"0")+"-"+String(c.getUTCDate()).padStart(2,"0")+" "+String(c.getUTCHours()).padStart(2,"0")+":"+String(c.getUTCMinutes()).padStart(2,"0")+":00"},utcToLocalDateTime=e=>{if(!e||"null"===e||""===e)return"";const t=e.replace(" ","T")+"Z",r=new Date(t),n=parseInt(localStorage.getItem("timezone_offset_hours")||"-5"),a=new Date(r.getTime()+60*n*60*1e3);return a.getUTCFullYear()+"-"+String(a.getUTCMonth()+1).padStart(2,"0")+"-"+String(a.getUTCDate()).padStart(2,"0")+"T"+String(a.getUTCHours()).padStart(2,"0")+":"+String(a.getUTCMinutes()).padStart(2,"0")},parseUTCDate=e=>{if(!e||"null"===e||""===e)return null;const t=e.replace(" ","T"),r=t+(t.includes("Z")?"":"Z");return new Date(r)},getStatusLabel=e=>({received:"Requ√™te Re√ßue",diagnostic:"Diagnostic",in_progress:"En Cours",waiting_parts:"En Attente Pi√®ces",private:"üîí Priv√©",completed:"Termin√©",archived:"Archiv√©"}[e]||e),getElapsedTime=e=>{const t=getNowEST(),r=e.includes("T")?e:e.replace(" ","T"),n=new Date(r+(r.includes("Z")?"":"Z")),a=parseInt(localStorage.getItem("timezone_offset_hours")||"-5"),o=new Date(n.getTime()+60*a*60*1e3);if(isNaN(o.getTime()))return{days:0,hours:0,minutes:0,seconds:0,color:"text-gray-500",bgColor:"bg-gray-50",icon:"‚ö™"};const s=t-o;if(s<0)return{days:0,hours:0,minutes:0,seconds:0,color:"text-gray-500",bgColor:"bg-gray-50",icon:"‚ö™"};const i=Math.floor(s/864e5);let l="text-green-700",g="bg-green-50 border-green-200",c="üü¢";return i>=7?(l="text-red-700 font-bold",g="bg-red-50 border-red-300",c="üî¥"):i>=3?(l="text-amber-700 font-semibold",g="bg-amber-50 border-amber-200",c="üü†"):i>=1&&(l="text-yellow-700",g="bg-yellow-50 border-yellow-200",c="üü°"),{days:i,hours:Math.floor(s%864e5/36e5),minutes:Math.floor(s%36e5/6e4),seconds:Math.floor(s%6e4/1e3),color:l,bgColor:g,icon:c}},formatElapsedTime=e=>e.days>0?e.days+"j "+String(e.hours).padStart(2,"0")+":"+String(e.minutes).padStart(2,"0"):e.hours>0?e.hours+"h "+String(e.minutes).padStart(2,"0")+":"+String(e.seconds).padStart(2,"0"):e.minutes>0?e.minutes+"min "+String(e.seconds).padStart(2,"0")+"s":e.seconds+"s",API_URL="/api",DEFAULT_COMPANY_TITLE="Gestion de la maintenance et des r√©parations",DEFAULT_COMPANY_SUBTITLE="Les Produits Verriers International (IGP) Inc.",ROLE_LEVELS={super_admin:4,support:4,admin:3,owner:3,director:3,supervisor:2,coordinator:2,planner:2,foreman:2,team_leader:2,technician:1,senior_technician:1,operator:1,furnace_operator:1,inspector:1,quality_inspector:1,storekeeper:1,safety_officer:1,viewer:0,guest:0,auditor:0,client:0},getUserLevel=e=>e?ROLE_LEVELS[e.toLowerCase()]??0:0,canAccess=(e,t)=>getUserLevel(e)>=t,isAdminOrAbove=e=>canAccess(e,3),isManagerOrAbove=e=>canAccess(e,2),isWorkerOrAbove=e=>canAccess(e,1),getLevelLabel=e=>({4:"Super Admin",3:"Administrateur",2:"Gestionnaire",1:"Employ√©",0:"Consultation"}[e]??"Inconnu");console.log("[RBAC] Syst√®me de niveaux charg√©. Fonctions disponibles: getUserLevel(), canAccess(), isAdminOrAbove(), isManagerOrAbove()");