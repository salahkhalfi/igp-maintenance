const UserList=({users:e,currentUser:t,onEdit:a,onDelete:r,onResetPassword:l,onOpenMessage:o,onCreate:n})=>{const[s,c]=React.useState(""),[i,m]=React.useState(20),u=React.useMemo(()=>parseInt(localStorage.getItem("timezone_offset_hours")||"-5"),[]),d=React.useMemo(()=>({superadmin:"üõ°Ô∏è SUPPORT",admin:"üëë Administrateur",director:"üìä Directeur G√©n√©ral",supervisor:"‚≠ê Superviseur",coordinator:"üéØ Coordonnateur Maintenance",planner:"üìÖ Planificateur Maintenance",senior_technician:"üîß Technicien Senior",technician:"üîß Technicien",team_leader:"üëî Chef √âquipe Production",furnace_operator:"üî• Op√©rateur Four",operator:"üë∑ Op√©rateur",safety_officer:"üõ°Ô∏è Agent Sant√© & S√©curit√©",quality_inspector:"‚úì Inspecteur Qualit√©",storekeeper:"üì¶ Magasinier",viewer:"üëÅÔ∏è Lecture Seule"}),[]),b=React.useMemo(()=>({superadmin:"bg-purple-600 text-white",admin:"bg-red-100 text-red-800",director:"bg-red-50 text-red-700",supervisor:"bg-yellow-100 text-yellow-800",coordinator:"bg-amber-100 text-amber-800",planner:"bg-amber-100 text-amber-800",senior_technician:"bg-blue-100 text-blue-800",technician:"bg-blue-50 text-blue-700",team_leader:"bg-emerald-100 text-emerald-800",furnace_operator:"bg-green-100 text-green-800",operator:"bg-green-50 text-green-700",safety_officer:"bg-indigo-100 text-indigo-800",quality_inspector:"bg-slate-100 text-slate-700",storekeeper:"bg-violet-100 text-violet-800",viewer:"bg-gray-100 text-gray-800"}),[]),g=React.useCallback(e=>1===e.is_super_admin?"superadmin":e.role,[]),f=React.useCallback(e=>{const t="object"==typeof e?g(e):e;return d[t]||"üë§ "+t},[d,g]),p=React.useCallback(e=>{const t="object"==typeof e?g(e):e;return b[t]||"bg-gray-100 text-gray-800"},[b,g]),x=React.useCallback(e=>{if(!e)return{color:"text-gray-500",status:"Jamais connect√©",time:"",dot:"bg-gray-400"};const t=getNowEST(),a=new Date((e.includes("T")?e:e.replace(" ","T"))+(e.includes("Z")?"":"Z")),r=t-new Date(a.getTime()+36e5*u),l=Math.floor(r/6e4);if(l<5)return{color:"text-green-600",status:"En ligne",time:"Actif maintenant",dot:"bg-green-500"};if(l<60)return{color:"text-yellow-600",status:"Actif r√©cemment",time:"Il y a "+l+" min",dot:"bg-yellow-500"};const o=Math.floor(r/36e5);if(o<24)return{color:"text-blue-700",status:"Actif aujourd'hui",time:"Il y a "+o+"h",dot:"bg-amber-600"};const n=Math.floor(r/864e5);return 1===n?{color:"text-red-600",status:"Inactif",time:"Hier",dot:"bg-red-500"}:{color:"text-red-600",status:"Inactif",time:"Il y a "+n+" jours",dot:"bg-red-500"}},[u]),y=React.useCallback(e=>"admin"===t.role||"supervisor"===t.role&&"technician"===e.role,[t.role]),w=React.useMemo(()=>{if(!e)return[];if(!s)return e;const t=s.toLowerCase();return e.filter(e=>(e.full_name||"").toLowerCase().includes(t)||(e.email||"").toLowerCase().includes(t))},[e,s]),R=React.useMemo(()=>w.slice(0,i),[w,i]);return React.createElement("div",{className:"flex-1 overflow-y-auto p-3 sm:p-6"},React.createElement("div",{className:"mb-4 flex flex-col sm:flex-row gap-3"},"admin"===t.role||"supervisor"===t.role?React.createElement(React.Fragment,null,React.createElement("button",{onClick:n,className:"px-6 py-3 bg-gradient-to-br from-blue-600 via-blue-700 to-blue-800 text-white rounded-xl font-bold transition-all shadow-[0_8px_16px_rgba(249,115,22,0.4),0_4px_8px_rgba(0,0,0,0.1),inset_0_1px_0_rgba(255,255,255,0.3)] hover:shadow-[0_12px_24px_rgba(249,115,22,0.5),0_6px_12px_rgba(0,0,0,0.2),inset_0_1px_0_rgba(255,255,255,0.4)] hover:-translate-y-1 active:translate-y-0 active:shadow-[0_4px_8px_rgba(249,115,22,0.3),inset_0_2px_4px_rgba(0,0,0,0.2)] border-t border-blue-300/50"},"Cr√©er un utilisateur"),"admin"===t.role?React.createElement("button",{onClick:()=>window.openDataImport?window.openDataImport("users"):alert("Fonction non disponible"),className:"px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold transition-all shadow-md flex items-center justify-center gap-2"},React.createElement("i",{className:"fas fa-file-import"}),"Import CSV"):null):null,React.createElement("div",{className:"flex-1 relative"},React.createElement("input",{type:"text",autoComplete:"off",placeholder:"Rechercher par nom ou email...",value:s,onChange:e=>c(e.target.value),className:"w-full px-4 py-2 pl-10 bg-white border-2 border-gray-300 rounded-lg shadow-sm focus:border-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-200 transition-all",onKeyDown:e=>{"Escape"===e.key&&c("")}}),React.createElement("i",{className:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s&&React.createElement("button",{onClick:()=>c(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600"},React.createElement("i",{className:"fas fa-times"})))),React.createElement("div",{className:"space-y-4"},React.createElement("p",{className:"text-lg mb-4"},s?w.length+" r√©sultat(s) sur "+(e||[]).length:(e||[]).length+" utilisateur(s)"),R.map(e=>{const n=x(e.last_login),s=y(e);return React.createElement("div",{key:e.id,className:"bg-white rounded-lg p-4 border border-gray-200 hover:bg-gray-50 transition-colors"},React.createElement("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3"},React.createElement("div",{className:"flex-1"},React.createElement("div",{className:"flex items-center gap-3 mb-2"},React.createElement("h4",{className:"font-bold text-lg"},e.full_name),React.createElement("span",{className:"px-3 py-1 rounded-full text-xs font-semibold "+p(e)},f(e))),React.createElement("p",{className:"text-sm text-gray-600"},React.createElement("i",{className:"fas fa-envelope mr-2"}),e.email),React.createElement("p",{className:"text-xs text-gray-500 mt-1"},React.createElement("i",{className:"far fa-clock mr-2"}),"Cr√©√© le: "+formatDateEST(e.created_at,!1)),s?React.createElement("div",{className:"flex flex-col gap-1 mt-2 pt-2 border-t border-gray-200"},React.createElement("div",{className:"flex items-center gap-1.5"},React.createElement("div",{className:"w-2 h-2 rounded-full "+n.dot}),React.createElement("span",{className:"text-xs font-bold "+n.color},n.status),n.time?React.createElement("span",{className:"text-xs "+n.color}," - "+n.time):null),e.last_login?React.createElement("span",{className:"text-xs text-gray-400 ml-3.5"},"Derni√®re connexion: "+formatDateEST(e.last_login,!0)):null):null),React.createElement("div",{className:"flex flex-col sm:flex-row gap-2 mt-2 sm:mt-0"},e.id!==t.id&&o?React.createElement("button",{onClick:()=>o({id:e.id,full_name:e.full_name,role:e.role,first_name:e.first_name,last_name:e.last_name,email:e.email}),className:"w-full sm:w-auto px-4 py-2.5 bg-gradient-to-br from-blue-600 via-blue-700 to-blue-800 text-white rounded-lg font-bold text-sm transition-all shadow-md border-t border-blue-300/50"},React.createElement("i",{className:"fas fa-comment mr-1"}),"Message"):null,e.id===t.id||e.id!==t.id&&("supervisor"!==t.role||"admin"!==e.role)&&"technician"!==t.role?React.createElement(React.Fragment,null,React.createElement("button",{onClick:()=>a(e),className:"w-full sm:w-auto px-4 py-2.5 bg-gradient-to-br from-blue-400 via-blue-500 to-blue-600 text-white rounded-lg font-bold text-sm transition-all shadow-md border-t border-blue-300/50"},React.createElement("i",{className:"fas fa-edit mr-1"}),"Modifier"),React.createElement("button",{onClick:()=>l(e.id,e.full_name),className:"w-full sm:w-auto px-4 py-2.5 bg-gradient-to-br from-yellow-400 via-yellow-500 to-yellow-600 text-white rounded-lg font-bold text-sm transition-all shadow-md border-t border-yellow-300/50"},React.createElement("i",{className:"fas fa-key mr-1"}),"MdP"),e.id!==t.id?React.createElement("button",{onClick:()=>r(e.id,e.full_name),className:"w-full sm:w-auto px-4 py-2.5 bg-gradient-to-br from-red-400 via-red-500 to-red-600 text-white rounded-lg font-bold text-sm transition-all shadow-md border-t border-red-300/50"},React.createElement("i",{className:"fas fa-trash mr-1"}),"Supprimer"):null):null)))}),w.length>i?React.createElement("button",{onClick:()=>m(e=>e+20),className:"w-full py-3 mt-4 bg-gray-100 text-gray-600 font-bold rounded-xl hover:bg-gray-200 transition-colors border-2 border-gray-200 dashed"},"Charger plus ("+(w.length-i)+" restants)"):null))};window.UserList=UserList;